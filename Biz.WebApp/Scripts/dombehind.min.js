function NewUid(){for(var t="",i,n=0;n<32;n++)i=Math.random()*16|0,(n==8||n==12||n==16||n==20)&&(t+="-"),t+=(n==12?4:n==16?i&3|8:i).toString(16);return t}function ExtendIIdentity(){return{__uuid:NewUid()}}function using(n,t){try{t(n)}finally{n.Dispose()}}var StringSplitOptions,z_indexKey,w_dynamicPrefix,__extends,annotationCollection,__lazyCollection,DomBehind;(function(n){var t=function(){function n(){}return n}();n.EventArgs=t})(DomBehind||(DomBehind={})),function(n){var t=function(){function n(n){n===void 0&&(n=!1);this.Cancel=n}return n}();n.CancelEventArgs=t}(DomBehind||(DomBehind={}));__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t}(n.EventArgs);n.CollectionChangedEventArgs=t}(DomBehind||(DomBehind={})),function(n){var t=function(){function n(n){this.Message=n}return n.prototype.ToString=function(){return this.Message},n}();n.Exception=t}(DomBehind||(DomBehind={}));__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t=function(n){function t(t,i,r){var u=n.call(this,i)||this;return u.JqXHR=t,u.TextStatus=i,u.ErrorThrown=r,u}return __extends(t,n),Object.defineProperty(t.prototype,"ErrorStatus",{get:function(){return this.JqXHR?this.JqXHR.status:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ErrorTitle",{get:function(){if(this.JqXHR){var n=this.JqXHR.responseJSON;return n.Message?n.Message:$(this.JqXHR.responseText).filter("title").text()}return this.TextStatus+":"+this.ErrorThrown},enumerable:!0,configurable:!0}),t.prototype.ToString=function(){return"status:"+this.ErrorStatus+"\n"+this.ErrorTitle},t}(n.Exception);n.AjaxException=t}(DomBehind||(DomBehind={})),function(n){var t;(function(n){var i=function(){function n(n,t){this.Message=n;this.Selector=t}return n}(),t;n.ValidationException=i;t=function(){function n(n){this.Items=n}return n}();n.AggregateValidationException=t})(t=n.Validation||(n.Validation={}))}(DomBehind||(DomBehind={})),function(n){var t=function(){function n(){this.handlers=[];this._disposed=!1}return Object.defineProperty(n.prototype,"EventName",{get:function(){return this._eventName},set:function(n){this._eventName=n},enumerable:!0,configurable:!0}),n.prototype.AddHandler=function(n){this.handlers.push(n)},n.prototype.RemoveHandler=function(n){this.handlers=this.handlers.filter(function(t){return t!==n})},n.prototype.Raise=function(n,t){this.handlers.slice(0).forEach(function(i){return i(n,t)})},n.prototype.Clear=function(){var n=this;$.each(this.handlers,function(t){n.handlers[t]=null});this.handlers=[]},n.prototype.Dispose=function(){this._disposed||this.handlers&&(this.handlers.length=0);this._disposed=!0},n}(),i;n.TypedEvent=t;i=function(){function n(n){this._eventName=n}return n.prototype.Create=function(){var n=new t;return n.EventName=this.EventName,n},Object.defineProperty(n.prototype,"EventName",{get:function(){return this._eventName},enumerable:!0,configurable:!0}),n.RegisterAttached=function(t){return new n(t)},n}();n.EventBuilder=i}(DomBehind||(DomBehind={}));__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t=function(n){function t(t){var i=n.call(this)||this;return i.Name=t,i}return __extends(t,n),t}(n.EventArgs);n.PropertyChangedEventArgs=t}(DomBehind||(DomBehind={}));__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t=function(n){function t(t,i,r){var u=n.call(this)||this;return u.Name=t,u.OldValue=i,u.NewValue=r,u}return __extends(t,n),t}(n.EventArgs);n.PropertyChangingEventArgs=t}(DomBehind||(DomBehind={})),function(n){var t=function(){function t(){this.PropertyChanged=new n.TypedEvent;this._dic={};this._disposed=!1}return t.prototype.GetProperty=function(n,t){var i=this._dic[n];return Object.IsNullOrUndefined(i)?t:i},t.prototype.SetProperty=function(n,t){var i=!1,r=this.GetProperty(n);return t!==r&&(i=!0,this._dic[n]=t,this._dic[n+"_old___"]=r,this.OnPropertyChanged(n)),i},t.prototype.Dispose=function(){this._disposed||(this._dic=null,this.PropertyChanged&&this.PropertyChanged.Dispose());this._disposed=!0},t.prototype.OnPropertyChanged=function(t){this.PropertyChanged.Raise(this,new n.PropertyChangedEventArgs(t))},t}();n.NotifiableImp=t}(DomBehind||(DomBehind={}));__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t=function(){function n(n,t){this.DataContext=n;this.MemberPath=t}return n.prototype.SetValue=function(n){var i=this.MemberPath.split("."),t=this.DataContext,r;if($.each(i.slice(0,i.length-1),function(n,i){if(Object.IsNullOrUndefined(t))return!1;t=t[i]}),Object.IsNullOrUndefined(t))return null;r=i[i.length-1];t[r]=n},n.prototype.GetValue=function(){var t=this.MemberPath.split("."),n=this.DataContext,i;return($.each(t.slice(0,t.length-1),function(t,i){if(Object.IsNullOrUndefined(n))return!1;n=n[i]}),Object.IsNullOrUndefined(n))?null:(i=t[t.length-1],n[i])},n.prototype.Dispose=function(){this.DataContext=null;this.MemberPath=null},n}(),i,r;n.PropertyInfo=t;i=function(n){function t(i,r){var u=n.call(this,i,t.ParsePropertyPath(r))||this;return u.Lamda=r,u}return __extends(t,n),t.ParsePropertyPath=function(n){var i=t.NameOf(n);return i.split(".").slice(1).join(".")},t.NameOf=function(n){var r=t._extractor_Minified.exec(n+""),i=r[1];return i.charAt(i.length-1)==="}"&&(r=t._extractor.exec(n+""),i=r[1]),i},t.prototype.Dispose=function(){this.Lamda=null;n.prototype.Dispose.call(this)},t.Path=function(n){return t.ParsePropertyPath(n)},t.GetValueCore=function(n,i){var r=new t(n,i);return r.GetValue()},t._extractor=new RegExp("return (.*);"),t._extractor_Minified=new RegExp("return (.*)}"),t}(t);n.LamdaExpression=i;r=function(n){function t(t){var i=n.call(this,null,".")||this;return i.Value=t,i}return __extends(t,n),t.prototype.SetValue=function(){},t.prototype.GetValue=function(){return this.Value},t}(t);n.BooleanFakeExpression=r}(DomBehind||(DomBehind={}));__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(t){var i=function(t){function i(r,u){var f=t.call(this)||this;return f.DisplayMemberPath=u,f.CurrentChanging=new n.TypedEvent,f.CurrentChanged=new n.TypedEvent,f.Added=new n.TypedEvent,f.Removed=new n.TypedEvent,f.engaged=!1,f.Source=new collections.LinkedList,f.List=new collections.LinkedList,$.each(r,function(n,t){f.Source.add(t);f.List.add(t)}),f.ViewReflected=i.ViewReflectedStatus.None,f}return __extends(i,t),Object.defineProperty(i.prototype,"Current",{get:function(){return this._current},set:function(n){this.OnCurrentChanging().Cancel||(this._current=n,this.ViewReflected=i.ViewReflectedStatus.NoReflected,this.engaged)||(this.OnCurrentChanged(),this.OnPropertyChanged("Current"))},enumerable:!0,configurable:!0}),i.prototype.OnCurrentChanging=function(){var t=new n.CancelEventArgs;return this.CurrentChanging.Raise(this,t),t},i.prototype.OnCurrentChanged=function(){this.engaged||this.CurrentChanged.Raise(this,new n.EventArgs)},i.prototype.Find=function(n){return this.List.toArray().FirstOrDefault(n)},i.prototype.Contains=function(n){var i=this,t;return n instanceof Array?(t=!0,$.each(n,function(n,r){if(!i.List.contains(r))return t=!1,!1}),t):this.List.contains(n)},i.prototype.Select=function(n){return this.Current=n,this},i.prototype.UnSelect=function(){return this.Current=null,this},i.prototype.MoveFirst=function(){return this.Current=this.List.first(),this},i.prototype.MoveLast=function(){return this.Current=this.List.last(),this},i.prototype.Refresh=function(){return this.RefreshRaw(),this.OnPropertyChanged(),this},i.prototype.RefreshRaw=function(){var n=this;this.List=new collections.LinkedList;$.each(this.Source.toArray(),function(t,i){n.Filter?n.Filter(i)&&n.List.add(i):n.List.add(i)});this.Current&&(this.Contains(this.Current)||this.MoveFirst())},i.prototype.OnPropertyChanged=function(t){this.engaged||this.PropertyChanged.Raise(this,new n.PropertyChangedEventArgs(t))},i.prototype.Begin=function(){return this.engaged=!0,this},i.prototype.End=function(){return this.engaged=!1,this},i.prototype.Add=function(t){this.Source.add(t);this.RefreshRaw();this.ViewReflected=i.ViewReflectedStatus.NoReflected;var r=new n.CollectionChangedEventArgs;r.Item=t;this.Added.Raise(this,r);this.OnPropertyChanged("Source - Add")},i.prototype.Remove=function(t){this.Source.remove(t);this.RefreshRaw();this.ViewReflected=i.ViewReflectedStatus.NoReflected;var r=new n.CollectionChangedEventArgs;r.Item=t;this.Removed.Raise(this,r);this.OnPropertyChanged("Source - Remove")},i.prototype.ToArray=function(){var n=this;return this.Filter?this.List.toArray().Where(function(t){return n.Filter(t)}):this.List.toArray()},i}(n.NotifiableImp);t.ListCollectionView=i})(t=n.Data||(n.Data={}))}(DomBehind||(DomBehind={})),function(n){var t;(function(n){var t;(function(n){var t;(function(n){n[n.None=0]="None";n[n.NoReflected=1]="NoReflected";n[n.Reflected=2]="Reflected"})(t=n.ViewReflectedStatus||(n.ViewReflectedStatus={}))})(t=n.ListCollectionView||(n.ListCollectionView={}))})(t=n.Data||(n.Data={}))}(DomBehind||(DomBehind={})),function(n){var t;(function(n){var t;(function(n){n[n.Explicit=0]="Explicit";n[n.LostForcus=1]="LostForcus";n[n.PropertyChanged=2]="PropertyChanged"})(t=n.UpdateSourceTrigger||(n.UpdateSourceTrigger={}))})(t=n.Data||(n.Data={}))}(DomBehind||(DomBehind={})),function(n){var t;(function(n){var t;(function(n){n[n.TwoWay=0]="TwoWay";n[n.OneWay=1]="OneWay"})(t=n.BindingMode||(n.BindingMode={}))})(t=n.Data||(n.Data={}))}(DomBehind||(DomBehind={}));__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t}(collections.LinkedList);n.List=t}(DomBehind||(DomBehind={})),function(n){var t=function(){function t(t,i){var r;if(this.source=t,this.marks=i,this.PropertyChanging=new n.TypedEvent,this.PropertyChanged=new n.TypedEvent,t!=null){var u=Object.keys(t),e=function(){var n=u[r];if(String.IsNullOrWhiteSpace(n))return"continue";i?i.Any(function(t){return t===n})&&f.Recurcive(t,n,null):f.Recurcive(t,n,null)},f=this;for(r=0;r<u.length;r++)e()}}return t.Register=function(n){for(var r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];return new t(n,r)},t.prototype.Recurcive=function(n,t,i){var r=n[t],e=i?i+"."+t:t,f,u;if((Object.defineProperty(n,t,this.CreateDescriptor(e,r)),!Object.IsNullOrUndefined(r))&&typeof r=="object")for(f=Object.keys(r),u=0;u<f.length;u++)this.Recurcive(r,f[u],e)},Object.defineProperty(t.prototype,"Source",{get:function(){return this.source},enumerable:!0,configurable:!0}),t.prototype.CreateDescriptor=function(t,i){var f=this.PropertyChanging,e=this.PropertyChanged,r=new n.PropertyChangedEventArgs(t),u=this.source;return{get:function(){return i},set:function(t){f.Raise(u,new n.PropertyChangingEventArgs(r.Name,i,t));i=t;e.Raise(u,r)},enumerable:!0,configurable:!0}},t}();n.Observable=t}(DomBehind||(DomBehind={}));Object.defineProperty(String.prototype,"ExtendedPrototype",{configurable:!0,enumerable:!1,writable:!0,value:function(n,t){var i=this;Object.defineProperty(n,i,{configurable:!0,enumerable:!1,writable:!0,value:t})}});"Where".ExtendedPrototype(Array.prototype,function(n){var t=this;return t.filter(function(t){return n(t)})});"Select".ExtendedPrototype(Array.prototype,function(n){var t=this;return t.map(function(t){return n(t)})});"Any".ExtendedPrototype(Array.prototype,function(n){var t=this;return n?t.some(function(t){return n(t)}):t.length!==0});"OrderBy".ExtendedPrototype(Array.prototype,function(n){var t=this;return t.sort(function(t,i){return n(t)-n(i)})});"OrderByDecording".ExtendedPrototype(Array.prototype,function(n){var t=this;return t.sort(function(t,i){return n(i)-n(t)})});"FirstOrDefault".ExtendedPrototype(Array.prototype,function(n){var t=this;return n&&(t=t.filter(function(t){return n(t)})),0<t.length?t[0]:null});"LastOrDefault".ExtendedPrototype(Array.prototype,function(n){var t=this;return n&&(t=t.filter(function(t){return n(t)})),0<t.length?t[t.length-1]:null});"GroupBy".ExtendedPrototype(Array.prototype,function(n){var i=this,t=[];return $.each(i,function(i,r){var u=n(r),f;t.some(function(n){return n.Key===u})||t.push({Key:u,Values:[]});f=t.FirstOrDefault(function(n){return n.Key===u});f.Values.push(r)}),t});"SequenceEqual".ExtendedPrototype(Array.prototype,function(n,t){var r=this,u,i,f,e;if(Object.IsNullOrUndefined(r)||Object.IsNullOrUndefined(n)||r.length!==n.length)return!1;for(u=!0,i=0;i<r.length;i++)if(f=r[i],e=n[i],t){if(!t(f,e)){u=!1;break}}else if(f!==e){u=!1;break}return u});Object.IsNullOrUndefined=function(n){return n==null?!0:n===null?!0:typeof n=="undefined"?!0:!1};Object.IsPromise=function(n){if(Object.IsNullOrUndefined(n)||typeof n=="object"&&typeof n.then!="function")return!1;var t=String($.Deferred().then),i=String(n.then);return t===i};String.IsNullOrEmpty=function(n){return!n};String.IsNullOrWhiteSpace=function(n){return String.IsNullOrEmpty(n)||n.replace(/\s/g,"").length<1};String.Split=function(n,t){return n.split(t)},function(n){n[n.None=0]="None";n[n.RemoveEmptyEntries=1]="RemoveEmptyEntries"}(StringSplitOptions||(StringSplitOptions={}));"Split".ExtendedPrototype(String.prototype,function(n,t){var i=this;return Object.IsNullOrUndefined(t)||t===StringSplitOptions.RemoveEmptyEntries?i.split(n).filter(function(n){return!String.IsNullOrWhiteSpace(n)}):i.split(n)});"Escape".ExtendedPrototype(String.prototype,function(){var n=this;return n.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")});"UnEscape".ExtendedPrototype(String.prototype,function(){var n=this;return n.replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">")});"Replace".ExtendedPrototype(String.prototype,function(n,t){var i=this;return i.split(n).join(t)});z_indexKey="z_indexKey";$.GenerateZIndex=function(){var t=$.GetDomStorage(z_indexKey,2e3),n=t+1;return $.SetDomStorage(z_indexKey,n),n};$.GetLocalStorage=function(n,t){return window.localStorage.getItem(n)?JSON.parse(window.localStorage.getItem(n)):t};$.SetLocalStorage=function(n,t){window.localStorage.setItem(n,JSON.stringify(t))};$.GetSessionStorage=function(n,t){return window.sessionStorage.getItem(n)?JSON.parse(window.sessionStorage.getItem(n)):t};$.SetSessionStorage=function(n,t){window.sessionStorage.setItem(n,JSON.stringify(t))};$.GetDomStorage=function(n,t){var i=$("body").find("#DomStorage_"+n).val();return i?JSON.parse(i):t};$.SetDomStorage=function(n,t){$("body").find("#DomStorage_"+n).length===0&&$("<input>",{type:"hidden",id:"DomStorage_"+n}).appendTo("body");$("body").find("#DomStorage_"+n).val(JSON.stringify(t))};$.SetRootUri=function(n){n&&$.SetLocalStorage("RootUri",n)};$.AbsoluteUri=function(n){var t=$.GetLocalStorage("RootUri","");return""+t+n};w_dynamicPrefix="__Framework";$.GetWindowDynamic=function(n){var t=w_dynamicPrefix+"."+n;return window[t]};$.SetWindowDynamic=function(n,t){var i=w_dynamicPrefix+"."+n;window[i]=t};$.fn.ValidityState=function(){var t=this,n=t.validity;return Object.IsNullOrUndefined(n)&&$.each(t,function(t,i){return n=i.validity,Object.IsNullOrUndefined(n)?void 0:!1}),n};$.fn.HasError=function(){var n=this,t=n.ValidityState();return!t.valid};$.fn.SetCustomError=function(n){var t=this;Object.IsNullOrUndefined(t.setCustomValidity)?$.each(t,function(t,i){Object.IsNullOrUndefined(i.setCustomValidity)||i.setCustomValidity(n)}):t.setCustomValidity(n)};$.fn.ClearCustomError=function(){var n=this;n.SetCustomError("")};$.fn.CheckValidity=function(){var n=this,t=!0;Object.IsNullOrUndefined(n.checkValidity)?$.each(n,function(n,i){Object.IsNullOrUndefined(i.checkValidity)||(t=i.checkValidity())}):t=n.checkValidity()};$.fn.Raise=function(n){var t=this;t.trigger(n.EventName)},function(n){var t=function(){function n(n){this._ctor=n}return n.prototype.CreateInstance=function(){return new this._ctor},n}();n.TypedFactory=t}(DomBehind||(DomBehind={})),function(n){var t=function(){function t(){}return t.AddService=function(n,i,r){r===void 0&&(r=0);t.contextList.push({Context:n,GetType:i,Priority:r})},t.RemoveService=function(n){t.contextList=t.contextList.filter(function(t){return t.Context!==n})},t.GetService=function(i){var r=t.contextList.Where(function(n){return n.Context===i}).OrderBy(function(n){return n.Priority}).FirstOrDefault(),u;return r?(u=new n.TypedFactory(r.GetType()),u.CreateInstance()):null},t.CreateInstance=function(t){var i=new n.TypedFactory(t());return i.CreateInstance()},t.contextList=[],t}();n.Repository=t}(DomBehind||(DomBehind={})),function(n){var t;(function(n){var t=function(){function t(n){this._propertyName=n}return Object.defineProperty(t.prototype,"PropertyName",{get:function(){return this._propertyName},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"GetValue",{get:function(){return this._getter},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"SetValue",{get:function(){return this._setter},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"UpdateSourceTrigger",{get:function(){return this._updateSourceTrigger},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"BindingMode",{get:function(){return this._bindingMode},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Ensure",{get:function(){return this._ensure},enumerable:!0,configurable:!0}),t.RegisterAttached=function(i,r,u,f,e,o){f===void 0&&(f=n.UpdateSourceTrigger.Explicit);e===void 0&&(e=n.BindingMode.TwoWay);var s=new t(i);return s._getter=r,s._setter=u,s._updateSourceTrigger=f,s._bindingMode=e,s._ensure=o,s},t}();n.DependencyProperty=t})(t=n.Data||(n.Data={}))}(DomBehind||(DomBehind={})),function(n){var t;(function(t){var i=function(){function i(){this.Trigger=t.UpdateSourceTrigger.Explicit;this.Mode=t.BindingMode.TwoWay;this.Validators=new n.Validation.ValidatorCollection}return i}();t.BindingPolicy=i})(t=n.Data||(n.Data={}))}(DomBehind||(DomBehind={})),function(n){var t;(function(n){var t=function(){function t(){this.BindingPolicy=new n.BindingPolicy;this.Priolity=0;this._disposed=!1}return t.prototype.Dispose=function(){this._disposed||(this.DataContext=null,this.Element=null);this._disposed=!0},t}();n.BindingBehavior=t})(t=n.Data||(n.Data={}))}(DomBehind||(DomBehind={}));__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(t){var i=function(i){function r(){var t=i!==null&&i.apply(this,arguments)||this;return t.Marks=[],t.AdditionalInfo=new collections.LinkedDictionary,t.UpdateSourceEvent=new n.TypedEvent,t.UpdateTargetEvent=new n.TypedEvent,t.Events=[],t}return __extends(r,i),Object.defineProperty(r.prototype,"PInfo",{get:function(){return this._pinfo},set:function(n){this._pinfo!==n&&(this._pinfo=n,n&&this.Marks.push(n.MemberPath))},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"ValueCore",{get:function(){var n=this.Property.GetValue(this.Element);return Object.IsNullOrUndefined(this.BindingPolicy.Converter)||(n=this.BindingPolicy.Converter.ConvertBack(n)),n},enumerable:!0,configurable:!0}),r.prototype.UpdateSource=function(){if(this.BindingPolicy.Mode!==t.BindingMode.OneWay&&!Object.IsNullOrUndefined(this.Property)&&!Object.IsNullOrUndefined(this.Property.GetValue)&&(this.PInfo.SetValue(this.ValueCore),this.UpdateSourceEvent.Raise(this,this.ValueCore),this.DataContext instanceof n.NotifiableImp)){var i=new n.PropertyChangedEventArgs(this.PInfo.MemberPath);this.DataContext.PropertyChanged.Raise(this,i)}},r.prototype.UpdateTarget=function(){if(!Object.IsNullOrUndefined(this.Property)&&!Object.IsNullOrUndefined(this.Property.SetValue)){var n=this.PInfo.GetValue();Object.IsNullOrUndefined(this.BindingPolicy.Converter)||(n=this.BindingPolicy.Converter.Convert(n));this.Property.SetValue(this.Element,n);this.UpdateTargetEvent.Raise(this,n)}},r.prototype.Ensure=function(){var i=this,n;if(this.BindingPolicy.Trigger===t.UpdateSourceTrigger.LostForcus){n="focusout";this.Events.push(n);this.Element.off(n);this.Element.on(n,function(){i.UpdateSource()})}this.Property&&this.Property.Ensure&&this.Property.Ensure(this)},r.prototype.EventsOff=function(){var n=this;Object.IsNullOrUndefined(this.Element)||Object.IsNullOrUndefined(this.Events)||$.each(this.Events,function(t,i){String.IsNullOrEmpty(i)||n.Element.off(i)})},r.prototype.Dispose=function(){this._disposed||(this.EventsOff(),this.Property=null,this.PInfo&&this.PInfo.Dispose(),this.PInfo=null,this.Marks.length=0,i.prototype.Dispose.call(this))},r}(t.BindingBehavior);t.DataBindingBehavior=i})(t=n.Data||(n.Data={}))}(DomBehind||(DomBehind={}));__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(t){var i=function(t){function i(){var n=t!==null&&t.apply(this,arguments)||this;return n.ActionPolicyCollection=[],n}return __extends(i,t),i.prototype.Ensure=function(){var n=this;if(this.ActionHandle=function(t){return n.OnTrigger(t)},this.Event&&!String.IsNullOrWhiteSpace(this.Event.EventName))this.Element.on(this.Event.EventName,function(t){return n.ActionHandle(t)});this.EventHandle=function(t,i){return n.Do(t,i)};this.Event&&this.Event.AddHandler(this.EventHandle);this.Element.is("a")&&!this.Element.attr("href")&&this.Element.attr("href","javascript:void(0);")},i.prototype.OnTrigger=function(n){this.Event.Raise(this,n)},Object.defineProperty(i.prototype,"ActionInvoker",{get:function(){if(!this._actionInvoker){var t=n.Application.Current.DefaultActionPolicy,i=this.ActionPolicyCollection.concat(t);this._actionInvoker=this.CreateActionInvoker(i)}return this._actionInvoker},enumerable:!0,configurable:!0}),i.prototype.CreateActionInvoker=function(n){var i=this,t=[];return n&&(t=t.concat(n)),t=t.OrderBy(function(n){return n.Priority()}),$.each(t,function(n,r){var u=n+1;u<t.length&&(r.NextPolicy=t[u]);r.Behavior=i}),t[0]},i.prototype.Do=function(n,t){var i=this;this.AllowBubbling||t.stopPropagation&&t.stopPropagation();this.ActionInvoker.Do(function(){var n;return i.Action&&(n=i.ActionParameterCount===1?i.Action(i.DataContext):i.ActionParameterCount===2?i.Action(i.DataContext,t):i.Action(i.DataContext)),n})},i.prototype.Dispose=function(){this._disposed||(Object.IsNullOrUndefined(this.Element)||(Object.IsNullOrUndefined(this.Event)||(String.IsNullOrWhiteSpace(this.Event.EventName)||this.Element.off(this.Event.EventName,this.ActionHandle),this.ActionHandle=null,this.Action=null,this.Event.RemoveHandler(this.EventHandle),this.EventHandle=null,this.Event=null),this.Element=null),this.ActionParameterCount=null,t.prototype.Dispose.call(this))},i}(t.BindingBehavior);t.ActionBindingBehavior=i})(t=n.Data||(n.Data={}))}(DomBehind||(DomBehind={}));__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(n){var t=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),t.prototype.Ensure=function(){this.View=this.GetView(this.DataContext);this.ViewModel=this.GetViewModel(this.DataContext);this.View.Container=this.Element;this.View.DataContext=this.ViewModel;this.View.Ensure()},t.prototype.Dispose=function(){this._disposed||(Object.IsNullOrUndefined(this.View)||(this.View.Dispose(),this.View=null),Object.IsNullOrUndefined(this.ViewModel)||(this.ViewModel.Dispose(),this.ViewModel=null),this.GetView=null,this.GetViewModel=null,n.prototype.Dispose.call(this))},t}(n.BindingBehavior);n.ViewViewModelBindingBehavior=t})(t=n.Data||(n.Data={}))}(DomBehind||(DomBehind={}));__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(n){var t=function(t){function i(){var n=t!==null&&t.apply(this,arguments)||this;return n._disposed=!1,n}return __extends(i,t),i.prototype.Ensure=function(){var t=this,n=[],i=this.toArray().GroupBy(function(n){return n.Element});i.forEach(function(t){var i=t.Values.OrderBy(function(n){return n.Priolity});i.forEach(function(t){n.push(t)})});this.clear();n.forEach(function(n){t.add(n);n.Ensure()})},i.prototype.ListDataBindingBehavior=function(t){var i=this.toArray().filter(function(t){return t instanceof n.DataBindingBehavior});return String.IsNullOrWhiteSpace(t)||(i=i.filter(function(n){return n.Marks.some(function(n){return n===t})})),i},i.prototype.UpdateTarget=function(n){var t=this.ListDataBindingBehavior(n);$.each(t,function(n,t){t.UpdateTarget()})},i.prototype.UpdateSource=function(n){var t=this.ListDataBindingBehavior(n);$.each(t,function(n,t){t.UpdateSource()})},i.prototype.Dispose=function(){this._disposed||($.each(this.toArray(),function(n,t){return t.Dispose()}),this.clear());this._disposed=!0},i}(collections.LinkedList);n.BindingBehaviorCollection=t})(t=n.Data||(n.Data={}))}(DomBehind||(DomBehind={})),function(n){var t=function(){function t(n){this.Owner=n}return t.prototype.Element=function(n){return typeof n=="string"?(this.CurrentElement=this.Owner.Container.find(n),this.CurrentSelector=n):this.CurrentElement=n,this.CurrentBehavior=null,this},t.prototype.Binding=function(t,i,r,u){var f=this.Add(new n.Data.DataBindingBehavior),e;return f.Property=t,f.PInfo=new n.LamdaExpression(this.Owner.DataContext,i),f.BindingPolicy.Trigger=Object.IsNullOrUndefined(u)?t.UpdateSourceTrigger:u,f.BindingPolicy.Mode=Object.IsNullOrUndefined(r)?t.BindingMode:r,e=new n.Data.DataBindingBehaviorBuilder(this.Owner),e.CurrentBehavior=this.CurrentBehavior,e.CurrentElement=this.CurrentElement,e.PartialMark(f.PInfo.MemberPath)},t.prototype.BindingViewViewModel=function(t,i){var r=this.Add(new n.Data.ViewViewModelBindingBehavior);return r.GetView=t,r.GetViewModel=i,this},t.prototype.BindingAction=function(t,i,r){var u,f;return r===void 0&&(r=!1),u=this.Add(new n.Data.ActionBindingBehavior),u.Event=t.Create(),u.Action=i,u.ActionParameterCount=i.length,u.AllowBubbling=r,f=new n.Data.ActionBindingBehaviorBuilder(this.Owner),f.CurrentBehavior=this.CurrentBehavior,f.CurrentElement=this.CurrentElement,f},t.prototype.Add=function(n){return this.CurrentBehavior=n,n.DataContext=this.Owner.DataContext,n.Element=this.CurrentElement,this.Owner.BindingBehaviors.add(n),n},t}();n.BindingBehaviorBuilder=t}(DomBehind||(DomBehind={}));__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(t){var i=function(n){function t(t){return n.call(this,t)||this}return __extends(t,n),Object.defineProperty(t.prototype,"Behavior",{get:function(){return this.CurrentBehavior},enumerable:!0,configurable:!0}),t.prototype.PartialMark=function(){for(var i=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return $.each(t,function(n,t){i.Behavior.Marks.push(t)}),this},t.prototype.Converter=function(n){return this.Behavior.BindingPolicy.Converter=n,this},t.prototype.AddValidator=function(n){return this.Behavior.BindingPolicy.Validators.add(n),n.Behavior=this.Behavior,n},t}(n.BindingBehaviorBuilder);t.DataBindingBehaviorBuilder=i})(t=n.Data||(n.Data={}))}(DomBehind||(DomBehind={}));__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(t){var i=function(n){function t(t){return n.call(this,t)||this}return __extends(t,n),Object.defineProperty(t.prototype,"Behavior",{get:function(){return this.CurrentBehavior},enumerable:!0,configurable:!0}),t.prototype.ActionPolicy=function(){for(var i=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return $.each(t,function(n,t){i.Behavior.ActionPolicyCollection.push(t)}),this},t}(n.BindingBehaviorBuilder);t.ActionBindingBehaviorBuilder=i})(t=n.Data||(n.Data={}))}(DomBehind||(DomBehind={})),function(n){var t;(function(n){var t=function(){function t(){}return t.prototype.Do=function(t){var i=this,r,o,u,f;try{if(this.Begin(),r=Object.IsNullOrUndefined(this.NextPolicy)?t():this.NextPolicy.Do(t),Object.IsPromise(r))return o=void 0,u=r,u.done(function(){i.Done();i.Always()}).fail(function(t){var r=new n.ActionPolicyExceptionEventArgs(i,t);return i.Fail(r),i.Always(),r.Handled?void 0:r}),u;this.Done();this.Always()}catch(e){if(f=new n.ActionPolicyExceptionEventArgs(this,e),this.Fail(f),this.Always(),!f.Handled)throw e;}},t}();n.ActionPolicy=t})(t=n.Data||(n.Data={}))}(DomBehind||(DomBehind={}));__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(t){var i=function(n){function t(t,i){var r=n.call(this)||this;return r.Data=i,r.Handled=!1,r.Sender=t,r}return __extends(t,n),t}(n.EventArgs);t.ActionPolicyExceptionEventArgs=i})(t=n.Data||(n.Data={}))}(DomBehind||(DomBehind={}));__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(t){var i=function(t){function i(){var n=t!==null&&t.apply(this,arguments)||this;return n._priority=1,n}return __extends(i,t),i.prototype.Priority=function(){return this._priority},i.prototype.Begin=function(){},i.prototype.Done=function(){},i.prototype.Fail=function(t){if(this.Behavior.DataContext){var i=this.Behavior.DataContext;if(i.Catch&&i.Catch(t),t.Handled)return}n.Application.Current.UnhandledException(t.Data);t.Handled=!0},i.prototype.Always=function(){},i}(t.ActionPolicy);t.ExceptionHandlingActionPolicy=i})(t=n.Data||(n.Data={}))}(DomBehind||(DomBehind={}));__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(t){var i=function(t){function i(){var n=t!==null&&t.apply(this,arguments)||this;return n._priority=50,n}return __extends(i,t),i.prototype.Priority=function(){return this._priority},i.prototype.Begin=function(){},i.prototype.Done=function(){},i.prototype.Fail=function(t){var r=this,i;this.Supported&&(t.Data instanceof n.Validation.AggregateValidationException?(i=t.Data,$.each(i.Items,function(n,t){r.SetCustomError(t)}),t.Handled=!0):t.Data instanceof n.Validation.ValidationException&&(this.SetCustomError(t.Data),t.Handled=!0))},i.prototype.SetCustomError=function(n){this.Owner.find(n.Selector).SetCustomError(n.Message)},Object.defineProperty(i.prototype,"Supported",{get:function(){return this.ViewModel?this.View?this.Owner?!0:!1:!1:!1},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"ViewModel",{get:function(){return this.Behavior.DataContext},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"View",{get:function(){return this.ViewModel.View},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"Owner",{get:function(){return this.View.Container},enumerable:!0,configurable:!0}),i.prototype.Always=function(){},i}(t.ActionPolicy);t.ValidationExceptionHandlingActionPolicy=i})(t=n.Data||(n.Data={}))}(DomBehind||(DomBehind={}));__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(n){var u=function(){function n(){this.Color="rgba(255, 255, 255, 0.8)";this.Custom="";this.Fade=!0;this.Fontawesome="";this.Image=null;this.ImagePosition="center center";this.MaxSize="100px";this.MinSize="20px";this.ResizeInterval=50;this.Size="50%";this.ZIndex=65535}return n}(),i=function(n){function t(t){var i=n.call(this)||this;return i._priority=100,i._option=$.extend(!0,{},new u,t),i}return __extends(t,n),Object.defineProperty(t.prototype,"Option",{get:function(){return this._option},enumerable:!0,configurable:!0}),t.prototype.Priority=function(){return this._priority},t.prototype.Begin=function(){var r=this,t=this.Container(),n=$("<div>",{"class":"loadingoverlay",css:{"background-color":this.Option.Color,display:"flex","flex-direction":"column","align-items":"center","justify-content":"center"}}),i;this.Option.ZIndex!==undefined&&n.css("z-index",this.Option.ZIndex);this.Option.Image&&n.css({"background-image":"url("+this.Option.Image+")","background-position":this.Option.ImagePosition,"background-repeat":"no-repeat"});this.Option.Fontawesome&&$("<div>",{"class":"loadingoverlay_fontawesome "+this.Option.Fontawesome}).appendTo(n);this.Option.Custom&&$(this.Option.Custom).appendTo(n);this.IsWholePage()?n.css({position:"fixed",top:0,left:0,width:"100%",height:"100%"}):n.css("position",t.css("position")=="fixed"?"fixed":"absolute");this.Resize(n);this.Option.ResizeInterval>0&&(i=setInterval(function(){return r.Resize(n)},this.Option.ResizeInterval),t.data("LoadingOverlayResizeIntervalId",i));this.Option.Fade?this.Option.Fade===!0?this.Option.Fade=[400,200]:(typeof this.Option.Fade=="string"||typeof this.Option.Fade=="number")&&(this.Option.Fade=[this.Option.Fade,this.Option.Fade]):this.Option.Fade=[0,0];t.data({LoadingOverlay:n,LoadingOverlayFadeOutDuration:this.Option.Fade[1]});n.hide().appendTo("body").fadeIn(this.Option.Fade[0])},t.prototype.Resize=function(n){var t=this.Container(),f=this.IsWholePage(),r,u,i;f||(r=t.css("position")=="fixed"?t.position():t.offset(),n.css({top:r.top+parseInt(t.css("border-top-width"),10),left:r.left+parseInt(t.css("border-left-width"),10),width:t.innerWidth(),height:t.innerHeight()}));u=f?$(window):t;i="auto";this.Option.Size&&this.Option.Size!="auto"&&(i=Math.min(u.innerWidth(),u.innerHeight())*parseFloat(this.Option.Size)/100,this.Option.MaxSize&&i>parseInt(this.Option.MaxSize,10)&&(i=parseInt(this.Option.MaxSize,10)+"px"),this.Option.MinSize&&i<parseInt(this.Option.MinSize,10)&&(i=parseInt(this.Option.MinSize,10)+"px"));n.css("background-size",i);n.children(".loadingoverlay_fontawesome").css("font-size",i)},t.prototype.Done=function(){},t.prototype.Fail=function(){},t.prototype.Always=function(){var n=this.Container(),t=n.data("LoadingOverlayResizeIntervalId");t&&clearInterval(t);n.data("LoadingOverlay").fadeOut(n.data("LoadingOverlayFadeOutDuration"),function(){$(this).remove()});n.removeData(["LoadingOverlay","LoadingOverlayFadeOutDuration","LoadingOverlayResizeIntervalId"])},t}(n.ActionPolicy),t,r;n.WaitingOverlayActionPolicy=i;t=function(n){function t(t,i){var r=n.call(this,i)||this;return r._container=t,r.Option.Image="/Content/images/preloader.gif",r}return __extends(t,n),t.prototype.Container=function(){return this._container},t.prototype.IsWholePage=function(){return!1},t}(i);n.ElementWaitingOverlayActionPolicy=t;r=function(n){function t(t){return n.call(this,$(document),t)||this}return __extends(t,n),t.prototype.IsWholePage=function(){return!0},t}(t);n.WindowWaitingOverlayActionPolicy=r})(t=n.Data||(n.Data={}))}(DomBehind||(DomBehind={})),function(n){var t;(function(n){n.ActionBindingBehaviorBuilder.prototype.WaitingOverlay=function(t){var i=this;return t||(t=new n.WindowWaitingOverlayActionPolicy),i.ActionPolicy(t),i}})(t=n.Data||(n.Data={}))}(DomBehind||(DomBehind={}));__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(t){var i=function(n){function t(){return n.call(this,"This exception is a safe exception issued to prevent double press")||this}return __extends(t,n),t}(n.Exception),r=function(t){function r(){var i=t!==null&&t.apply(this,arguments)||this;return i._priority=10,i.IsEnabled=n.UIElement.IsEnabledProperty,i.referencecount=0,i.engaged=!1,i}return __extends(r,t),r.prototype.Priority=function(){return this._priority},r.prototype.Begin=function(){if(++this.referencecount,this.engaged)throw new i;this.engaged=!0;this.IsEnabled.SetValue(this.Behavior.Element,!1)},r.prototype.Done=function(){},r.prototype.Fail=function(n){n.Data instanceof i&&(n.Handled=!0)},r.prototype.Always=function(){--this.referencecount==0&&(this.engaged=!1,this.IsEnabled.SetValue(this.Behavior.Element,!0))},r}(t.ActionPolicy);t.SuppressDuplicateActionPolicy=r})(t=n.Data||(n.Data={}))}(DomBehind||(DomBehind={})),function(n){var t;(function(n){var t;(function(n){n[n.CenterScreen=0]="CenterScreen";n[n.Manual=1]="Manual"})(t=n.ModalStartupLocation||(n.ModalStartupLocation={}))})(t=n.Navigation||(n.Navigation={}))}(DomBehind||(DomBehind={})),function(n){var t;(function(t){var r="ModalClose",i="ReferenceCountKey",u=function(){function u(){this.DefaultSetting={FadeInDuration:100,FadeOutDuration:100,AllowCloseByClickOverlay:!0,ShowCloseButton:!0,StartupLocation:t.ModalStartupLocation.CenterScreen,StartupLocationTop:null,StartupLocationLeft:null}}return u.prototype.Move=function(n,t){n=$.AbsoluteUri(n);t?location.href=n:location.replace(n)},u.prototype.ShowModal=function(u,f){var o=$.extend(!0,this.DefaultSetting,f),s=$("<div>",{"class":"modal-overlay"}),e,h,l,a,c;if(s.css("z-index",$.GenerateZIndex()),$("body").css("overflow","hidden"),s.appendTo("body").fadeIn(o.FadeInDuration,function(){$.SetDomStorage(i,$.GetDomStorage(i,0)+1)}),typeof u=="string"){if(l=$.ajax({url:u,async:!1,type:"GET",cache:!1,error:function(t,i,r){h=new n.AjaxException(t,i,r)}}),h)throw h;a=l.responseText;e=$(a)}else e=u;e.find(".close").click(s,function(n){n.data.trigger(r)});o.ShowCloseButton||e.find(".close").hide();o.StartupLocation===t.ModalStartupLocation.Manual&&(Object.IsNullOrUndefined(o.StartupLocationTop)&&Object.IsNullOrUndefined(o.StartupLocationLeft)?(c=$.GetDomStorage(i,0)+1,e.find(".modal-dialog").css("top",-50+c*5+"%").css("left",-25+c*5+"%")):e.find(".modal-dialog").css("top",o.StartupLocationTop).css("left",o.StartupLocationLeft));s.append(e);e.find(".modal-dialog").draggable({handle:".modal-header",cursor:"move"});o.AllowCloseByClickOverlay&&(s.click(s,function(n){n.data.trigger(r)}),e.click(function(n){n.stopPropagation()}));s.off(r);s.on(r,{me:s,option:o,target:e},function(n){var u=$.Event("modalClosing"),e=n.data.target.find(".modal-body"),f,t;($(e.children()[0]).trigger(u),u.result!==!1)&&(f=n.data.option,t=n.data.me,t.off(r),t.fadeOut(f.FadeOutDuration,function(){t.remove();$.SetDomStorage(i,$.GetDomStorage(i,0)-1);$.GetDomStorage(i,0)===0&&$("body").css("overflow","auto")}))})},u}();t.DefaultNavigator=u})(t=n.Navigation||(n.Navigation={}))}(DomBehind||(DomBehind={})),function(n){var t;(function(n){var t=function(){function n(n){this._disposed=!1;this.Attribute=n}return Object.defineProperty(n.prototype,"AttributeValue",{get:function(){var n=this.ParseAttributeValue();return Object.IsNullOrUndefined(n)?"":n},enumerable:!0,configurable:!0}),n.prototype.ParseAttributeValue=function(){if(Object.IsNullOrUndefined(this.AttributeExpression))return null;var n=this.AttributeExpression;return typeof n=="string"||typeof n=="number"?this.AttributeExpression:this.AttributeExpression(this.Behavior.DataContext)},n.prototype.OnValidationg=function(){if(this.HasError=!1,this.Apply(),this.HasError=!this.Validate(this.Behavior.ValueCore),this.HasError){var n=this.ValidationMessage(this.Behavior.Element.ValidityState());String.IsNullOrWhiteSpace(n)||this.Behavior.Element.SetCustomError(n)}},n.prototype.Apply=function(){if(!Object.IsNullOrUndefined(this.AllowApply)){var n=this.AllowApply(this.Behavior.DataContext);if(!n){this.RemoveValidation();return}}this.AddValidation()},n.prototype.RemoveValidation=function(){String.IsNullOrWhiteSpace(this.Attribute)||this.Behavior.Element.removeAttr(this.Attribute);this.Behavior.Element.ClearCustomError()},n.prototype.AddValidation=function(){this.RemoveValidation();String.IsNullOrWhiteSpace(this.Attribute)||this.Behavior.Element.attr(this.Attribute,this.AttributeValue)},n.prototype.Validate=function(){return!this.Behavior.Element.HasError()},n.prototype.ValidationMessage=function(){if(Object.IsNullOrUndefined(this.Message))return null;var n=this.Message;return typeof n=="string"?this.Message:this.Message(this.Behavior.DataContext)},n.prototype.Dispose=function(){!this._disposed;this._disposed=!0},n}();n.Validator=t})(t=n.Validation||(n.Validation={}))}(DomBehind||(DomBehind={}));__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(n){var t=function(n){function t(){var t=n!==null&&n.apply(this,arguments)||this;return t._disposed=!1,t}return __extends(t,n),t.prototype.ClearValidator=function(){$.each(this.toArray(),function(n,t){return t.RemoveValidation()})},t.prototype.ApplyValidator=function(){$.each(this.toArray(),function(n,t){return t.Apply()})},t.prototype.Validate=function(){var n=!0;return $.each(this.toArray(),function(t,i){i.OnValidationg();i.HasError&&(n=!1)}),n},t.prototype.Dispose=function(){this._disposed||($.each(this.toArray(),function(n,t){return t.Dispose()}),this.clear());this._disposed=!0},t}(collections.LinkedList);n.ValidatorCollection=t})(t=n.Validation||(n.Validation={}))}(DomBehind||(DomBehind={}));__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(n){var t=function(n){function t(){return n.call(this,"maxlength")||this}return __extends(t,n),t.prototype.Dispose=function(){this._disposed||n.prototype.Dispose.call(this)},t}(n.Validator);n.MaxLengthValidator=t})(t=n.Validation||(n.Validation={}))}(DomBehind||(DomBehind={})),function(n){var t;(function(t){t.DataBindingBehaviorBuilder.prototype.MaxLength=function(t,i,r){var f=this,u=f.AddValidator(new n.Validation.MaxLengthValidator);return u.AttributeExpression=t,u.Message=i,u.AllowApply=r,f}})(t=n.Data||(n.Data={}))}(DomBehind||(DomBehind={}));__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(n){var t=function(n){function t(){return n.call(this,"pattern")||this}return __extends(t,n),t.prototype.RemoveValidation=function(){n.prototype.RemoveValidation.call(this);this.Behavior.Element.removeAttr("title")},t.prototype.ValidationMessage=function(t){var i=n.prototype.ValidationMessage.call(this,t);return String.IsNullOrWhiteSpace(i)&&this.Behavior.Element.attr("title",this.AttributeValue),i},t.prototype.Dispose=function(){this._disposed||n.prototype.Dispose.call(this)},t}(n.Validator);n.RegexValidator=t})(t=n.Validation||(n.Validation={}))}(DomBehind||(DomBehind={})),function(n){var t;(function(t){t.DataBindingBehaviorBuilder.prototype.Pattern=function(t,i,r){var f=this,u=f.AddValidator(new n.Validation.RegexValidator);return u.AttributeExpression=t,u.Message=i,u.AllowApply=r,f}})(t=n.Data||(n.Data={}))}(DomBehind||(DomBehind={}));__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(n){var t=function(n){function t(){return n.call(this,"required")||this}return __extends(t,n),t.prototype.Dispose=function(){this._disposed||n.prototype.Dispose.call(this)},t}(n.Validator);n.RequiredValidator=t})(t=n.Validation||(n.Validation={}))}(DomBehind||(DomBehind={})),function(n){var t;(function(t){t.DataBindingBehaviorBuilder.prototype.Required=function(t,i){var r=this,u=r.AddValidator(new n.Validation.RequiredValidator);return u.Message=t,u.AllowApply=i,r}})(t=n.Data||(n.Data={}))}(DomBehind||(DomBehind={})),function(n){var t;(function(n){n[n.PreLoad=1]="PreLoad";n[n.Reload=2]="Reload"})(t=n.PoolType||(n.PoolType={}))}(DomBehind||(DomBehind={})),function(n){var t;(function(t){var i=function(){function t(){}return t.Register=function(t,i){var r=this;i===void 0&&(i=2);$("body").ready(function(){for(var u,e=new n.TypedFactory(t()),f=0;f<i;f++)u=e.CreateInstance(),u.PoolType&n.PoolType.PreLoad&&u.Load(),r.Pool.push(u)})},t.Do=function(i,r){var u=null,f=[],e;return $.each(t.Pool,function(n,t){u?f.push(t):t instanceof i?u=t:f.push(t)}),t.Pool=f,u||(e=new n.TypedFactory(i),u=e.CreateInstance(),u.Load()),u.Do(r).always(function(){u.PoolType&n.PoolType.Reload&&(u.Terminate(),u.Load());t.Pool.push(u)})},t.Pool=[],t}();t.WorkerPool=i})(t=n.Threading||(n.Threading={}))}(DomBehind||(DomBehind={})),function(n){var t;(function(t){var i=function(){function t(){this.PoolType=n.PoolType.PreLoad}return Object.defineProperty(t.prototype,"Thread",{get:function(){return this._thread},enumerable:!0,configurable:!0}),t.prototype.Load=function(){this._thread||(this._thread=new Worker(this.WorkerScript))},Object.defineProperty(t.prototype,"WorkerScript",{get:function(){return null},enumerable:!0,configurable:!0}),t.prototype.Do=function(n){var t=$.Deferred();return this.Thread.onmessage=function(n){t.resolve(n.data)},this.Thread.onerror=function(n){console.error(n.filename+":("+n.lineno+")\n"+n.message);var i,r;try{$.each($(n.message),function(n,t){t instanceof HTMLTitleElement&&(i=t.text);t instanceof Comment&&(r=t.text)})}catch(u){console.error(u.message)}t.reject({ErrorMessage:i,Description:r})},this.Thread.postMessage(n),t.promise()},t.prototype.Terminate=function(){this._thread&&(this._thread.terminate(),this._thread=null)},t}();t.WorkerWrapper=i})(t=n.Threading||(n.Threading={}))}(DomBehind||(DomBehind={}));__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(t){n.Threading.WorkerPool.Register(function(){return i});var i=function(n){function t(){return n!==null&&n.apply(this,arguments)||this}return __extends(t,n),Object.defineProperty(t.prototype,"WorkerScript",{get:function(){return"/Scripts/dombehind-PlainXMLHttpRequest.js"},enumerable:!0,configurable:!0}),t}(n.Threading.WorkerWrapper);t.PlainXMLHttpRequestWorker=i})(t=n.Web||(n.Web={}))}(DomBehind||(DomBehind={})),function(n){var t;(function(t){var i=function(){function i(){this.Timeout=3e4}return i.prototype.Execute=function(t){var r,i=this.DefaultPostSetting,u;if(i.data=t,i.async=!1,i.error=function(t,i,u){r=new n.AjaxException(t,i,u)},u=$.ajax(i),r)throw r;return u.responseJSON},i.prototype.ExecuteAjax=function(t,i){var r=$.Deferred(),u=$.extend(!0,this.DefaultPostSetting,i);return u.data=t,u.async=!0,$.ajax(u).done(function(n){r.resolve(n)}).fail(function(t){r.reject(new n.AjaxException(t))}),r.promise()},i.prototype.ExecuteAsync=function(i){return n.Threading.WorkerPool.Do(t.PlainXMLHttpRequestWorker,{Url:$.AbsoluteUri(this.Url),Request:i})},Object.defineProperty(i.prototype,"DefaultPostSetting",{get:function(){return{type:"POST",dataType:"json",cache:!1,url:$.AbsoluteUri(this.Url),timeout:this.Timeout,traditional:!0}},enumerable:!0,configurable:!0}),i}();t.WebService=i})(t=n.Web||(n.Web={}))}(DomBehind||(DomBehind={})),function(n){var t=function(){function t(){}return t.ValueProperty=n.Data.DependencyProperty.RegisterAttached("val",function(n){return n.val()},function(n,t){return n.val(t)},n.Data.UpdateSourceTrigger.LostForcus,n.Data.BindingMode.TwoWay),t.IsEnabledProperty=n.Data.DependencyProperty.RegisterAttached("enabled",null,function(n,t){var i=t===!1?!0:!1;i===!0?(n.attr("disabled",""),n.addClass("disabled")):(n.removeAttr("disabled"),n.removeClass("disabled"))},n.Data.UpdateSourceTrigger.Explicit,n.Data.BindingMode.OneWay),t.PlaceHolderProperty=n.Data.DependencyProperty.RegisterAttached("placeholder",null,function(n,t){return n.attr("placeholder",t)},n.Data.UpdateSourceTrigger.Explicit,n.Data.BindingMode.OneWay),t.IsCheckedProperty=n.Data.DependencyProperty.RegisterAttached("checked",function(n){return n.get(0).checked},function(n,t){return n.get(0).checked=t},n.Data.UpdateSourceTrigger.LostForcus,n.Data.BindingMode.TwoWay),t.MaxLengthProperty=n.Data.DependencyProperty.RegisterAttached("maxlength",null,function(n,t){return n.attr("maxlength",t)},n.Data.UpdateSourceTrigger.Explicit,n.Data.BindingMode.OneWay),t.HtmlSource=n.Data.DependencyProperty.RegisterAttached("htmlSource",null,function(t,i){var r={url:i,async:!0,type:"GET",cache:!0};$.ajax(r).done(function(n){var i=$(n).find("#_Layout");t.append($(n))}).fail(function(t){throw new n.AjaxException(t);})},n.Data.UpdateSourceTrigger.Explicit,n.Data.BindingMode.OneWay),t.Click=n.EventBuilder.RegisterAttached("click"),t.LostFocus=n.EventBuilder.RegisterAttached("focusout"),t.Initialize=n.EventBuilder.RegisterAttached("initialize"),t.ViewLoaded=n.EventBuilder.RegisterAttached("viewLoaded"),t.ModalClosing=n.EventBuilder.RegisterAttached("modalClosing"),t}();n.UIElement=t}(DomBehind||(DomBehind={})),function(n){n.BindingBehaviorBuilder.prototype.InputType=function(n){var r=this,i=t[n];return n===t.DateTimeLocal&&(i="DateTime-Local"),i=i.toLowerCase(),r.CurrentElement.removeAttr("type"),r.CurrentElement.attr("type",i),r};var t;(function(n){n[n.Hidden=0]="Hidden";n[n.Text=1]="Text";n[n.Search=2]="Search";n[n.Tel=3]="Tel";n[n.Url=4]="Url";n[n.Email=5]="Email";n[n.Password=6]="Password";n[n.DateTime=7]="DateTime";n[n.Date=8]="Date";n[n.Month=9]="Month";n[n.Week=10]="Week";n[n.Time=11]="Time";n[n.DateTimeLocal=12]="DateTimeLocal";n[n.Number=13]="Number";n[n.Range=14]="Range";n[n.Color=15]="Color";n[n.Checkbox=16]="Checkbox";n[n.Radio=17]="Radio";n[n.File=18]="File";n[n.Submit=19]="Submit";n[n.Image=20]="Image";n[n.Reset=21]="Reset";n[n.Button=22]="Button"})(t=n.InputType||(n.InputType={}))}(DomBehind||(DomBehind={})),function(n){n.BindingBehaviorBuilder.prototype.Scrolling=function(){var n=this;return n.CurrentElement.click(function(n){var r=n.target,t=r.hash,i=$(t).offset();i&&(n.preventDefault(),$("html, body").animate({scrollTop:i.top},900,function(){window.location.hash=t}))}),n};n.BindingBehaviorBuilder.prototype.SlideAnimation=function(){var n=this,t=n.CurrentElement;return $(window).scroll(function(){t.each(function(){var n=$(this).offset().top,t=$(window).scrollTop();n<t+600&&$(this).addClass("slide")})}),n}}(DomBehind||(DomBehind={})),function(n){var t;(function(t){var i=function(){function t(n){var t=this;this.Behavior=n;this.UpdateTargetEventHandle=function(n,i){return t.OnUpdateTarget(n,i)};n.UpdateTargetEvent.AddHandler(this.UpdateTargetEventHandle);this.UpdateSourceEventHandle=function(n){return t.UpdateSource(n)};n.Element.off("change",this.UpdateSourceEventHandle);n.Element.on("change",this.UpdateSourceEventHandle);this.PropertyChangedEventHandle=function(n,i){return t.OnDataSourcePropertyChanged(n,i)};this.AddedHandle=function(n,i){return t.Added(n,i)};this.RemovedHandle=function(n,i){return t.Removed(n,i)}}return t.Register=function(n){if(n.Element&&!n.AdditionalInfo[t.IgnoreMark]&&!n.AdditionalInfo[t.InstanceMark]){var i=n.Element.prop("tagName");if(i!=="SELECT"){n.AdditionalInfo[t.IgnoreMark]=!0;return}n.AdditionalInfo[t.InstanceMark]=new t(n)}},t.prototype.UpdateSource=function(){var t,r,i;if(this.Behavior.PInfo&&(t=this.Behavior.PInfo.GetValue(),t instanceof n.Data.ListCollectionView)){if(r=t,r.OnCurrentChanging().Cancel)return this.Select(r),!1;i=[];$.each(this.Behavior.Element.find("option"),function(n,t){if(t.selected){var f=t.getAttribute("uuid"),u=r.Find(function(n){return n.__uuid===f});u&&i.push(u)}});t.Begin();t.Current=this.Multiple?i:0<i.length?i[0]:null;t.End()}},t.prototype.OnUpdateTarget=function(t,i){if(i instanceof n.Data.ListCollectionView)this.Render(i);else if(i instanceof Array){var r=[];$.each(i,function(n,t){r.push({Value:t})});this.Render(new n.Data.ListCollectionView(r,"Value"))}},t.prototype.OnDataSourcePropertyChanged=function(n,t){t.Name==="Current"&&this.Select(n);t.Name||this.Render(n)},t.prototype.Render=function(n){var t=this,i;this.HasChanges(n)&&(this.Behavior.Element.empty(),i=n.ToArray(),n.Grouping?$.each(i.GroupBy(n.Grouping),function(i,r){var u=$("<optgroup>",{label:r.Key}).appendTo(t.Behavior.Element);$.each(r.Values,function(i,r){t.RenderOption(u,n,r)})}):$.each(i,function(i,r){t.RenderOption(t.Behavior.Element,n,r)}),this.Select(n))},Object.defineProperty(t.prototype,"Multiple",{get:function(){return this.Behavior.Element.prop("multiple")?!0:!1},set:function(n){this.Behavior.Element.prop("multiple",n)},enumerable:!0,configurable:!0}),t.prototype.RenderOption=function(i,r,u){u.__uuid||(u=$.extend(u,ExtendIIdentity()));u.DisplayMemberPath||(u=$.extend(u,this.EnsureDisplayMemberPath(r.DisplayMemberPath)));var f=$('<option uuid="'+u.__uuid+'">'+t.GetDisplayValue(u,r.DisplayMemberPath)+"<\/option>");f.appendTo(i);u=$.extend(u,this.EnsureElement(f));u instanceof n.NotifiableImp&&(u.__EventMarked||(u.__EventMarked=!0,u.PropertyChanged.AddHandler(function(n){var i=n,r=t.GetDisplayValue(n,i.DisplayMemberPath);i.__Selector.val(r)})))},t.prototype.EnsureDisplayMemberPath=function(n){return{DisplayMemberPath:n}},t.prototype.EnsureElement=function(n){return{__Selector:n,__Element:n[0]}},t.prototype.Added=function(n){this.Render(n)},t.prototype.Removed=function(n){this.Render(n)},t.prototype.Select=function(n){return this.Multiple?this.MultipleSelect(n):this.SingleSelect(n)},t.prototype.SingleSelect=function(t){var i=t.Current;Object.IsNullOrUndefined(i)?this.Behavior.Element.selectpicker("val",null):(i.__Element.selected=!0,this.Behavior.Element.selectpicker("refresh"));t.ViewReflected=n.Data.ListCollectionView.ViewReflectedStatus.Reflected},t.prototype.MultipleSelect=function(t){var i=t.Current;Object.IsNullOrUndefined(i)?this.Behavior.Element.selectpicker("deselectAll"):$.each(i,function(n,t){var i=t;i.__Element.selected=!0});this.Behavior.Element.selectpicker("refresh");t.ViewReflected=n.Data.ListCollectionView.ViewReflectedStatus.Reflected},t.prototype.HasChanges=function(t){return t.ViewReflected===n.Data.ListCollectionView.ViewReflectedStatus.Reflected?!1:(t.ViewReflected===n.Data.ListCollectionView.ViewReflectedStatus.None&&(t.ViewReflected=n.Data.ListCollectionView.ViewReflectedStatus.NoReflected,t.Begin().Refresh().End(),this.Subscribe(t)),!0)},t.prototype.Subscribe=function(n){this.UnSubscribe(n);n.Removed.AddHandler(this.RemovedHandle);n.Added.AddHandler(this.AddedHandle);n.PropertyChanged.AddHandler(this.PropertyChangedEventHandle)},t.prototype.UnSubscribe=function(n){n.Added.RemoveHandler(this.AddedHandle);n.Removed.RemoveHandler(this.RemovedHandle);n.PropertyChanged.RemoveHandler(this.PropertyChangedEventHandle)},t.GetDisplayValue=function(t,i){var r=t;return i&&(r=new n.PropertyInfo(t,i).GetValue()),r},t.ItemsSourceProperty=n.Data.DependencyProperty.RegisterAttached("itemsSource",null,function(){},n.Data.UpdateSourceTrigger.Explicit,n.Data.BindingMode.OneWay,function(n){t.Register(n)}),t.AllowMultipleProperty=n.Data.DependencyProperty.RegisterAttached("multiple",null,function(n,t){var i=n.prop("multiple");i!==t&&(t===!0?n.prop("multiple",!0):n.prop("multiple",!1),n.selectpicker("destroy"),n.selectpicker())},n.Data.UpdateSourceTrigger.Explicit,n.Data.BindingMode.OneWay),t.IgnoreMark="Selector.Ignore",t.InstanceMark="Selector.Instance",t}();t.Selector=i})(t=n.Controls||(n.Controls={}))}(DomBehind||(DomBehind={})),function(n){var t;(function(t){var i=n.Controls.Selector;t.DataBindingBehaviorBuilder.prototype.Multiple=function(r){var u=this,f=u.Add(new t.DataBindingBehavior);return f.Property=i.AllowMultipleProperty,f.Priolity=-1,f.PInfo=r?new n.LamdaExpression(u.Owner.DataContext,r):new n.BooleanFakeExpression(!0),u}})(t=n.Data||(n.Data={}))}(DomBehind||(DomBehind={}));__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(t){var i=function(t){function i(){var n=t!==null&&t.apply(this,arguments)||this;return n.Options=[],n}return __extends(i,t),i.Register=function(n){if(n.Element&&!n.AdditionalInfo[i.IgnoreMark]&&!n.AdditionalInfo[i.InstanceMark]){var t=n.Element.prop("tagName");if(t!=="DIV"){n.AdditionalInfo[i.IgnoreMark]=!0;return}n.AdditionalInfo[i.InstanceMark]=new i(n)}},i.prototype.Render=function(n){var i,t;if(this.HasChanges(n)){for(this.Behavior.Element.empty(),this.HeaderContainer=$('<ul class="nav nav-tabs">'),this.ContentContainer=$('<div class="tab-content">'),this.Options.length=0,i=n.ToArray(),t=0;t<i.length;t++)this.NewAdd(n,i[t],t===0);this.HeaderContainer.appendTo(this.Behavior.Element);this.ContentContainer.appendTo(this.Behavior.Element)}},i.prototype.NewAdd=function(n,t,r){r===void 0&&(r=!1);var u=new i.BindingOption(this);return u.Source=n,u.Option=t,u.IsActive=r,u.Ensure(),this.Options.push(u),u},i.prototype.Added=function(n,t){this.NewAdd(n,t)},i.prototype.Removed=function(n,t){t.__header.detach();t.__content.detach()},i.ItemsSourceProperty=n.Data.DependencyProperty.RegisterAttached("itemsSource",null,function(){},n.Data.UpdateSourceTrigger.Explicit,n.Data.BindingMode.OneWay,function(n){i.Register(n)}),i.IgnoreMark="Tab.Ignore",i.InstanceMark="Tab.Instance",i}(t.Selector);t.Tab=i,function(i){var r=function(){function i(n){this.Parent=n}return Object.defineProperty(i.prototype,"HeaderContainer",{get:function(){return this.Parent.HeaderContainer},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"ContentContainer",{get:function(){return this.Parent.ContentContainer},enumerable:!0,configurable:!0}),i.prototype.Ensure=function(){var n=this,r,u,i;this.Option.__uuid||(this.Option.__uuid=NewUid());this.Option.DisplayMemberPath||(this.Option.DisplayMemberPath=this.Source.DisplayMemberPath);r=this.IsActive?"active":"";this.Header=$('<li class="'+r+'" uuid="'+this.Option.__uuid+'">').appendTo(this.HeaderContainer);this.Option.__header=this.Header;u=this.IsActive?"tab-pane fade in active":"tab-pane fade";this.Content=$('<div class="'+u+'" id="'+this.Option.__uuid+'">').appendTo(this.ContentContainer);this.Option.__content=this.Content;this.Content.on("RegisteredViewViewModel",function(i,r){var f=$(i.target),u;f.off("RegisteredViewViewModel");n.Option.View=r.View;n.Option.ViewModel=r.ViewModel;u=t.Selector.GetDisplayValue(r.ViewModel,n.Option.DisplayMemberPath);$('<a href="#'+n.Option.__uuid+'" data-toggle="tab">').text(u).appendTo(n.Header);n.PropertyChangedSafeHandle=function(t,i){return n.OnRecievePropertyChanged(i)};r.ViewModel.PropertyChanged.AddHandler(n.PropertyChangedSafeHandle)});i=this.Option;i.Uri&&this.Content.load(i.Uri)},i.prototype.OnRecievePropertyChanged=function(i){var u,r;switch(i.Name){case this.Option.DisplayMemberPath:u=t.Selector.GetDisplayValue(this.Option.ViewModel,this.Option.DisplayMemberPath);this.Header.find("a").text(u);break;case n.LamdaExpression.Path(function(n){return n.IsEnabled}):r=this.Option.ViewModel.IsEnabled;n.UIElement.IsEnabledProperty.SetValue(this.Header.find("a"),r);n.UIElement.IsEnabledProperty.SetValue(this.Header,r)}},i}();i.BindingOption=r}(i=t.Tab||(t.Tab={}))})(t=n.Controls||(n.Controls={}))}(DomBehind||(DomBehind={})),function(n){var t,i,r;(function(n){n[n.Infomation=0]="Infomation";n[n.Warning=1]="Warning";n[n.Error=2]="Error"})(t=n.MessageStatus||(n.MessageStatus={}));i=function(){function i(){}return i.ShowInfomation=function(n,r){i.ShowMessage(n,r,t.Infomation)},i.ShowWarning=function(n,r){i.ShowMessage(n,r,t.Warning)},i.ShowError=function(n,r){i.ShowMessage(n,r,t.Error)},i.ShowMessage=function(n,t,r){i.Container.ShowMessage(n,t,r)},i.ShowYesNo=function(n,t,r){i.Container.ShowYesNo(n,t,r)},i.ShowOkCancel=function(n,t,r){i.Container.ShowOkCancel(n,t,r)},i.BuiltIn=function(n){i._lazy=n},Object.defineProperty(i,"Container",{get:function(){if(i._container)return i._container;if(!i._lazy)throw new n.Exception("");var t=new n.TypedFactory(i._lazy());return i._container=t.CreateInstance(),i._container},enumerable:!0,configurable:!0}),i}();n.MessaageBox=i;i.BuiltIn(function(){return r});r=function(){function n(){}return n.prototype.ShowMessage=function(n){window.alert(n)},n.prototype.ShowYesNo=function(n,t,i){window.confirm(n)?i&&i.yesCallback&&i.yesCallback():i&&i.noCallBack&&i.noCallBack()},n.prototype.ShowOkCancel=function(n,t,i){window.confirm(n)?i&&i.okCallback&&i.okCallback():i&&i.cancelCallBack&&i.cancelCallBack()},n}()}(DomBehind||(DomBehind={}));__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t,i,r;(function(n){n[n.Default=0]="Default";n[n.Button=1]="Button";n[n.RadioButton=2]="RadioButton";n[n.Checkbox=3]="Checkbox";n[n.Separator=4]="Separator";n[n.Space=5]="Space";n[n.Menu=6]="Menu";n[n.CheckMenu=7]="CheckMenu";n[n.RadioMenu=8]="RadioMenu";n[n.DropHtml=9]="DropHtml";n[n.Html=10]="Html"})(t=n.W2ToolbarItemType||(n.W2ToolbarItemType={}));i=function(t){function i(){var i=t!==null&&t.apply(this,arguments)||this;return i.MenuList=new n.List,i}return __extends(i,t),i.prototype.Ensure=function(){var n={name:this.Name,items:this.MenuList.toArray()};this.ToolBar=this.Element.w2toolbar(n);t.prototype.Ensure.call(this)},i}(n.Data.ActionBindingBehavior);n.W2ToolBarBindingBehavior=i;r=function(i){function r(n){return i.call(this,n)||this}return __extends(r,i),r.prototype.AddMenuButton=function(n,i){return typeof n=="string"?this.AddMenu(n,t.Button,i):this.AddMenuBinding(n,t.Button,i),this},r.prototype.AddMenuCheckbox=function(n,i){return typeof n=="string"?this.AddMenu(n,t.Checkbox,i):this.AddMenuBinding(n,t.Checkbox,i),this},r.prototype.AddDropCheckMenubox=function(n,i){return typeof n=="string"?this.AddMenu(n,t.CheckMenu,i):this.AddMenuBinding(n,t.CheckMenu,i),this},r.prototype.AddMenu=function(t,i,r){var w=this,e=this.CurrentBehavior,u=NewUid(),f={id:u,text:t,type:this.TypeToString(i)},a,h,s,o,v,y,c,p,l;return r&&r.EnabledBinding&&(a=n.Data.DependencyProperty.RegisterAttached(u,function(){var n=$("#tb_"+e.Name+"_item_"+u);return!n.hasClass("disabled")},function(n,t){t?e.ToolBar.enable(u):e.ToolBar.disable(u)}),h=this.Add(new n.Data.DataBindingBehavior),h.Property=a,h.PInfo=new n.LamdaExpression(this.Owner.DataContext,r.EnabledBinding)),r&&r.ClickAction&&(s=new n.TypedEvent,s.EventName=u,o=this.Add(new n.Data.ActionBindingBehavior),o.Event=s,o.Action=r.ClickAction,o.ActionParameterCount=r.ClickAction.length,o.AllowBubbling=!1,f.onClick=function(n){s.Raise(w,n)}),r&&r.Icon&&(f.icon=r.Icon),r&&r.IsChecked&&(v=n.LamdaExpression.GetValueCore(this.Owner.DataContext,r.IsChecked),f.checked=v,y=n.Data.DependencyProperty.RegisterAttached("checked-"+u,function(){return f.checked},function(n,t){var r=n.attr("checked-"+u),i;r&&t===Boolean(r)||(n.attr("checked-"+u,t),f.checked=t,i=e.ToolBar,i&&(t&&i.check(u),i.refresh()))}),c=this.Add(new n.Data.DataBindingBehavior),c.Property=y,c.PInfo=new n.LamdaExpression(this.Owner.DataContext,r.IsChecked)),r&&r.ItemsBinding&&(p=n.Data.DependencyProperty.RegisterAttached("menuItems",function(){},function(n,t){if(f.items!=t){f.items=t;var i=e.ToolBar;i&&($.each(i.items,function(n,i){if(i.id===f.id)return i.items=t,i.selected=t.Where(function(n){return n.checked===!0}).Select(function(n){return n.id}),i.onRefresh=function(n){var i=n.item,r;i&&(r=i.selected,$.each(t,function(n,t){var i=r.Any(function(n){return n===t.id});t.onClick(i)}))},!1}),i.refresh(u))}}),l=this.Add(new n.Data.DataBindingBehavior),l.Property=p,l.PInfo=new n.LamdaExpression(this.Owner.DataContext,r.ItemsBinding)),e.MenuList.add(f),this.CurrentBehavior=e,f},r.prototype.AddMenuBinding=function(t,i,r){var f=this.CurrentBehavior,u=NewUid(),o=n.LamdaExpression.GetValueCore(this.Owner.DataContext,t),h=this.AddMenu(o,i,r),s=n.Data.DependencyProperty.RegisterAttached("title-"+u,function(){var n=$("#tb_"+f.Name+"_item_"+u+" .w2ui-tb-caption");return n.text()},function(n,t){var i=$("#tb_"+f.Name+"_item_"+u+" .w2ui-tb-caption");i.text(t)}),e=this.Add(new n.Data.DataBindingBehavior);e.Property=s;e.PInfo=new n.LamdaExpression(this.Owner.DataContext,t)},r.prototype.TypeToString=function(n){var i="button";switch(n){case t.Button:i="button";break;case t.Checkbox:i="check";break;case t.CheckMenu:i="menu-check"}return i},r}(n.BindingBehaviorBuilder);n.W2ToolBarBindingBehaviorBuilder=r;n.BindingBehaviorBuilder.prototype.BuildToolBar=function(t){var o=t,f=this,u=f.Add(new i),s,e;return u.AllowBubbling=!1,u.Name=name?name:NewUid(),t&&(s=n.EventBuilder.RegisterAttached("onClick"),u.Event=s.Create(),u.Action=o,u.ActionParameterCount=o.length),e=new r(f.Owner),e.CurrentElement=f.CurrentElement,e.CurrentBehavior=f.CurrentBehavior,e}}(DomBehind||(DomBehind={}));__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t,i,r;(function(n){n[n.Top=0]="Top";n[n.Left=1]="Left";n[n.Right=2]="Right";n[n.Main=3]="Main";n[n.Preview=4]="Preview";n[n.Bottom=5]="Bottom"})(t=n.W2LayoutType||(n.W2LayoutType={}));i=function(i){function r(){var n=i!==null&&i.apply(this,arguments)||this;return n.Types={},n}return __extends(r,i),r.GetIsVisible=function(n){var u=n.attr("parent-id"),i=w2ui[u],r,t;return i?(r=n.attr("w2layout-type"),t=i.get(r),!t)?null:!t.hidden:null},r.SetIsVisible=function(n,t){var e=n.attr("parent-id"),r=n.attr("w2layout-type"),i=w2ui[e],u,f;if(i){if(u=i.get(r),!u)return;f=u.hidden;t&&f?i.show(r,!1):t||f||i.hide(r,!1)}},Object.defineProperty(r.prototype,"DefaultOption",{get:function(){return{size:null,resizable:!1,style:"border: 1px solid #dfdfdf; padding: 5px;"}},enumerable:!0,configurable:!0}),r.prototype.Ensure=function(){var i=this,f=[],u;$.each(this.Types,function(u,e){var o=$.extend(!0,i.DefaultOption,e.Option),l=Number(u),h="",c,s;switch(l){case t.Top:h=o.type="top";break;case t.Left:h=o.type="left";break;case t.Right:h=o.type="right";break;case t.Main:h=o.type="main";break;case t.Preview:h=o.type="preview";break;case t.Bottom:h=o.type="bottom"}o.content=e.Container;f.push(o);o.content.attr("w2layout-type",h);e.Visibility&&(s=i.NewAdd(new n.Data.DataBindingBehavior),s.Property=r.IsVisibleProperty,s.PInfo=new n.LamdaExpression(i.DataContext,e.Visibility),s.Element=o.content);typeof e.Uri=="string"?(c=$.ajax({url:e.Uri,async:!0,type:"Get",cache:!1}),c.done(function(n){var t=$(n).filter(".body-content");o.content.append(t)}).fail(function(){})):(s=i.NewAdd(new n.Data.DataBindingBehavior),s.Property=r.UriProperty,s.PInfo=new n.LamdaExpression(i.DataContext,e.Uri),s.Element=o.content)});u=this.Element.attr("id");u||(u="root-"+NewUid().Replace("-",""));this.Element.w2layout({name:u,padding:4,panels:f})},r.IsVisibleProperty=n.Data.DependencyProperty.RegisterAttached("W2LayoutBinding-IsVisible",function(n){return r.GetIsVisible(n)},function(n,t){r.SetIsVisible(n,t)}),r.UriProperty=n.Data.DependencyProperty.RegisterAttached("W2LayoutBinding-Uri",function(n){return n.attr("W2LayoutBinding-Uri")},function(n,t){var u,r,i,f,e;(t||(t=""),u="w2layout-uri-"+t.Replace("/",""),r=n.attr(u),r||n.attr(u,r="id-"+NewUid()),i=n.find("#"+r),i.length===0&&(i=$('<div class="parent-size"><\/div>'),i.attr("id",r),n.append(i)),$.each(n.children(),function(n,t){$(t).hide()}),t)&&(i.show(),f=i.attr("loaded"),f||(e=$.ajax({url:t,async:!0,type:"Get",cache:!1}),e.done(function(n){var t=$(n).filter(".body-content");i.empty();i.append(t)}).fail(function(){})),i.attr("loaded","true"))}),r}(n.Data.BindingBehavior);n.W2LayoutBindingBehavior=i;r=function(n){function i(t){return n.call(this,t)||this}return __extends(i,n),i.prototype.Top=function(n,i,r){return this.AddLayout(t.Top,n,i,r),this},i.prototype.Left=function(n,i,r){return this.AddLayout(t.Left,n,i,r),this},i.prototype.Right=function(n,i,r){return this.AddLayout(t.Right,n,i,r),this},i.prototype.Main=function(n,i,r){return this.AddLayout(t.Main,n,i,r),this},i.prototype.Preview=function(n,i,r){return this.AddLayout(t.Preview,n,i,r),this},i.prototype.AddLayout=function(n,t,i,r){var f=this.CurrentBehavior,u=f.Element.attr("id"),e,o;u||(u=NewUid().Replace("-",""));e="panel-"+NewUid().Replace("-","");o=$('<div id="'+e+'" parent-id="'+u+'" class="parent-size"><\/div>');f.Types[n]={Uri:t,Visibility:r,Container:o,Option:i}},i}(n.BindingBehaviorBuilder);n.W2LayoutBindingBehaviorBuilder=r;n.BindingBehaviorBuilder.prototype.BuildLayout=function(){var n=this,u=n.Add(new i),t;return u.NewAdd=function(t){return n.Add(t)},t=new r(n.Owner),t.CurrentElement=n.CurrentElement,t.CurrentBehavior=u,t}}(DomBehind||(DomBehind={}));__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var u="w2sidebar-id",t="w2sidebar-dp",i=function(i){function r(){return i!==null&&i.apply(this,arguments)||this}return __extends(r,i),r.BuildW2Node=function(n){var i=n.Id,t;return i||(n.Id=i=""+NewUid()),t={id:i,text:n.Title},n.Image&&(t.img=n.Image),n.Icon&&(t.icon=n.Icon),n.Badge&&t.count,n.Style&&t.style,n.IsGroup&&(t.group=n.IsGroup,t.expanded=!0,t.collapsible=!1,n.AllowShowHideGroupNode&&(t.groupShowHide=n.AllowShowHideGroupNode)),n.Children&&(t.nodes=r.RecursiveNode(n.Children)),t},r.RecursiveNode=function(n){var t=[];return $.each(n,function(n,i){t.push(r.BuildW2Node(i))}),t},r.FindModel=function(n,t){var i;return $.each(n,function(n,u){return u.Id===t?(i=u,!1):u.Children&&(i=r.FindModel(u.Children,t),i)?!1:void 0}),i},r.prototype.Ensure=function(){},r.ItemsSource=n.Data.DependencyProperty.RegisterAttached(t,function(n){var i=n.attr(t);return $.GetWindowDynamic(i)},function(i,f){var s=i.attr(t),e,l,o,a,h,v,c;if(s||(s=NewUid(),i.attr(t,s)),$.SetWindowDynamic(s,f),e=i.attr("id"),e||(e="id-"+NewUid(),i.attr("id",e)),l=i.attr(u),o=$.GetWindowDynamic(l),f instanceof n.Data.ListCollectionView){if(a=f.ViewReflected,a===n.Data.ListCollectionView.ViewReflectedStatus.Reflected)return;f.ViewReflected=n.Data.ListCollectionView.ViewReflectedStatus.Reflected;h={name:e,nodes:r.RecursiveNode(f.ToArray()),onClick:function(n){var t=r.FindModel(f.ToArray(),n.target);t&&(t.__nativeEvent=n);o.ClickEvent.Raise(this,t)}};o.AllowMenuExpand&&(h.flatButton=!0,h.onFlat=function(n){o.Element.css("width",n.goFlat?"35px":"200px")});v=i.w2sidebar(h);c=f.Current;c&&(v.select(c.Id),o.ClickEvent.Raise(o,c));f.PropertyChanged.AddHandler(function(n,t){var i,r;String.IsNullOrWhiteSpace(t.Name)?(i=w2ui[e],i&&i.refresh()):t.Name==="Current"&&(r=f.Current,w2ui[e].select(r.Id),o.ClickEvent.Raise(n,r))})}}),r}(n.Data.BindingBehavior),r;n.W2SidebarBindingBehavior=i;r=function(n){function t(t){return n.call(this,t)||this}return __extends(t,n),t}(n.BindingBehaviorBuilder);n.W2SidebarBindingBehaviorBuilder=r;n.BindingBehaviorBuilder.prototype.BuildSidebar=function(t,f,e){var s=this,o=s.Add(new i),l,h,c;return o.ClickEvent=new n.TypedEvent,o.ClickEvent.EventName="NodeClick",o.Identity=NewUid(),o.AllowMenuExpand=e,s.CurrentElement.attr(u,o.Identity),$.SetWindowDynamic(o.Identity,o),l=s.Add(new n.Data.DataBindingBehavior),l.Property=i.ItemsSource,l.PInfo=new n.LamdaExpression(s.Owner.DataContext,t),h=this.Add(new n.Data.ActionBindingBehavior),h.Event=o.ClickEvent,h.Action=f,h.ActionParameterCount=f.length,h.AllowBubbling=!1,this.CurrentBehavior=o,c=new r(s.Owner),c.CurrentElement=s.CurrentElement,c.CurrentBehavior=o,c}}(DomBehind||(DomBehind={}));__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t,i,f,r,u;(function(n){n[n.Text=1]="Text";n[n.Int=2]="Int";n[n.Double=3]="Double";n[n.Date=4]="Date";n[n.Hex=5]="Hex";n[n.Money=6]="Money";n[n.Currency=7]="Currency";n[n.Percent=8]="Percent";n[n.Alphanumeric=9]="Alphanumeric";n[n.Time=10]="Time";n[n.Color=11]="Color";n[n.List=12]="List"})(t=n.FieldType||(n.FieldType={})),function(n){n[n.Number=1]="Number";n[n.Currency=2]="Currency";n[n.Money=3]="Money";n[n.Percent=4]="Percent";n[n.Time=5]="Time";n[n.Date=6]="Date";n[n.Age=7]="Age";n[n.Toggle=8]="Toggle"}(i=n.RenderType||(n.RenderType={}));f=function(){function t(n){this.Owner=n}return Object.defineProperty(t.prototype,"items",{get:function(){if(!this.itemSource)return null;if(!this.__items){var t=new n.LamdaExpression(this.Owner,this.itemSource);this.__items=t.GetValue()}return this.__items},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){return this.__type||(this.__type=r.FieldTypeToString(this.fieldType)),this.__type},enumerable:!0,configurable:!0}),t}();r=function(r){function u(){var n=r!==null&&r.apply(this,arguments)||this;return n.Column=[],n.__id=0,n}return __extends(u,r),Object.defineProperty(u.prototype,"IsMultiSelect",{get:function(){return this.GridOption&&this.GridOption.multiSelect?!0:!1},enumerable:!0,configurable:!0}),u.prototype.GenerateRecId=function(){return++this.__id},Object.defineProperty(u.prototype,"SelectedObject",{get:function(){var t=this.Grid.getSelection(),n;return!t||t.length===0?null:(n=[],$.each(this.Grid.records,function(i,r){t.Any(function(n){return n===r.recid})&&n.push(r)}),this.IsMultiSelect)?n:n.FirstOrDefault()},enumerable:!0,configurable:!0}),u.prototype.AddColumn=function(n){this.Column.push(n)},u.prototype.Ensure=function(){var t=this,r=this.Element.attr("id"),i,o,s,e;r||(r=NewUid(),this.Element.attr("id",r));$.each(this.Column,function(n,i){i.renderType&&(i.render=u.RenderTypeToString(i.renderType));i.editable&&(i.editable=$.extend(!0,new f(t.DataContext),i.editable))});i={name:r,columns:this.Column,show:{selectColumn:!1},multiSelect:!1,keyboard:!0};i.onDblClick=function(n){return t.OnDoubleClick(t.DataContext,n)};this.GridOption.footerOption&&(i.show.footer=!0);this.GridOption.headerOption&&(i.show.toolbar=!0,this.GridOption.headerOption.add&&(i.show.toolbarAdd=!0,i.onAdd=function(n){return t.OnToolbarAdd(t.DataContext,n)}),this.GridOption.headerOption.edit&&(i.show.toolbarEdit=!0,i.onEdit=function(n){return t.OnToolbarEdit(t.DataContext,n)}),this.GridOption.headerOption.save&&(i.show.toolbarSave=!0,i.onSave=function(n){return t.OnToolbarSave(t.DataContext,n)}),this.GridOption.headerOption.delete&&(i.show.toolbarDelete=!0,i.onDelete=function(n){return t.OnToolbarDelete(t.DataContext,n)}));this.GridOption.multiSelect&&(i.multiSelect=!0);this.GridOption.dragAndDropRow&&(i.reorderRows=!0);o=this.Column.Where(function(n){return!Object.IsNullOrUndefined(n.advancedSearch)});o.Any()&&(i.multiSearch=!0,i.searches=o.Select(function(n){return{field:n.field,caption:n.caption,type:u.FieldTypeToString(n.advancedSearch)}}));this.Grid=this.Element.w2grid(i);s=n.Data.DependencyProperty.RegisterAttached("itemsSource",function(){},function(i,r){var e,u,f;if(r instanceof n.Data.ListCollectionView&&(t.ListCollectionView=r,e=i.attr("id"),u=w2ui[e],u)){if(f=r.ToArray(),u.records===f)return;$.each(f,function(n,i){t.RowInjection(i)});u.clear(!0);u.records=f;u.total=f.length;u.refresh();u.onClick=function(n){t.OnSelect(t.DataContext,n);var i=$("#grid_"+e+"_focus");i.focus()};r.PropertyChanged.RemoveHandler(t.OnCurrentChanged);r.PropertyChanged.AddHandler(t.OnCurrentChanged)}});e=this.NewAdd(new n.Data.DataBindingBehavior);e.Property=s;e.PInfo=this.ItemsSource;e.Element=this.Element},u.prototype.SuppressListCollectionViewAction=function(t){this.ListCollectionView.Begin();t(this.ListCollectionView);this.ListCollectionView.ViewReflected=n.Data.ListCollectionView.ViewReflectedStatus.Reflected;this.ListCollectionView.End()},u.prototype.OnSelect=function(n,t){var r=t.recid,i=this.Grid.get(r);this.SuppressListCollectionViewAction(function(n){return n.Current=i});this.GridOption.onSelect(n,i)},u.prototype.OnDoubleClick=function(n,t){var u,i,f,r;if(this.GridOption&&this.GridOption.onDoubleClick&&(u=this.Element.attr("id"),i=w2ui[u],i)){f=t.recid;r=i.get(f);this.SuppressListCollectionViewAction(function(n){return n.Current=r});this.GridOption.onDoubleClick(n,r)}},u.prototype.OnToolbarAdd=function(n,t){if(this.GridOption&&this.GridOption.headerOption&&this.GridOption.headerOption.add){var i=this.GridOption.headerOption.add(n,t);i&&this.AddRow(i)}},u.prototype.AddRow=function(n){this.RowInjection(n);this.Grid.records.push(n);this.Grid.total=this.Grid.records.length;this.SuppressListCollectionViewAction(function(t){return t.Add(n)});this.Grid.refresh(n.recid);this.Grid.select(n.recid);this.Grid.scrollIntoView(n.recid)},u.prototype.OnToolbarEdit=function(n,t){if(this.GridOption&&this.GridOption.headerOption&&this.GridOption.headerOption.edit){var i=t.recid,r=this.Grid.get(i);this.GridOption.headerOption.edit(n,r)}},u.prototype.OnToolbarSave=function(n,t){if(this.GridOption&&this.GridOption.headerOption&&this.GridOption.headerOption.save){var i=t.recid,r=this.Grid.get(i);this.GridOption.headerOption.save(n,r)}},u.prototype.OnToolbarDelete=function(n,t){var i=this;this.GridOption&&this.GridOption.headerOption&&this.GridOption.headerOption.delete&&(t.force||(this._deleteTargets=this.SelectedObject),t.done&&t.done(function(){i.GridOption.headerOption.delete(n,i._deleteTargets)}))},u.prototype.OnCurrentChanged=function(n,t){String.IsNullOrWhiteSpace(t.Name)?this.Grid&&this.Grid.refresh():t.Name==="Current"},u.FieldTypeToString=function(n){var i="text";switch(n){case t.Text:i="text";break;case t.Int:i="int";break;case t.Double:i="float";break;case t.Date:i="date";break;case t.Hex:i="hex";break;case t.Money:i="money";break;case t.Currency:i="currency";break;case t.Percent:i="percent";break;case t.Alphanumeric:i="alphanumeric";break;case t.Time:i="time";break;case t.Color:i="color";break;case t.List:i="list"}return i},u.RenderTypeToString=function(n){var t="";switch(n){case i.Number:t="number";break;case i.Currency:t="currency";break;case i.Money:t="money";break;case i.Percent:t="percent";break;case i.Time:t="time";break;case i.Date:t="date";break;case i.Age:t="age";break;case i.Toggle:t="toggle"}return t},u.prototype.ParseCellStyles=function(n){var r=JSON.parse(n),u=[],i,t,f;for(i in r)for(t=0;t<this.Column.length;t++)if(f=this.Column[t],f.field===i){u[t]=r[i];break}return u},u.prototype.RowInjection=function(t){var u=this,r,i;t&&(t.w2ui||(t.w2ui={}),t.recid=this.GenerateRecId(),this.RowStyleBinding&&(r=this.RowStyleBinding(t),String.IsNullOrWhiteSpace(r)||(t.w2ui.style=r),t.__rowStyleObserver||(i=n.Observable.Register(t,n.LamdaExpression.Path(this.RowStyleBinding)),i.PropertyChanged.Clear(),i.PropertyChanged.AddHandler(function(n){var i=n.recid,r=u.RowStyleBinding(n);t.w2ui.style=r;u.Grid.refreshRow(i)}),t.__rowStyleObserver=i)),this.CellStyleBinding&&(r=this.CellStyleBinding(t),String.IsNullOrWhiteSpace(r)||(t.w2ui.style=this.ParseCellStyles(r)),i=n.Observable.Register(t,n.LamdaExpression.Path(this.CellStyleBinding)),i.PropertyChanged.Clear(),i.PropertyChanged.AddHandler(function(n){var i=n.recid,r=u.CellStyleBinding(n);t.w2ui.style=u.ParseCellStyles(r);u.Grid.refreshRow(i)})),this.RowClassBinding&&(r=this.RowClassBinding(t),String.IsNullOrWhiteSpace(r)||(t.w2ui.class=r),i=n.Observable.Register(t,n.LamdaExpression.Path(this.RowClassBinding)),i.PropertyChanged.Clear(),i.PropertyChanged.AddHandler(function(n){var i=n.recid,r=u.RowClassBinding(n);t.w2ui.class=r;u.Grid.refreshRow(i)})))},u.IsSpinningProperty=n.Data.DependencyProperty.RegisterAttached("w2ui.isSpinning",function(n){var t=n.attr("w2ui.isSpinning");return t?Boolean(t):!1},function(n,t){var r=n.attr("w2ui.isSpinning"),u,i;r==="true"&&t||(r!=="false"||t)&&(n.attr("w2ui.isSpinning",String(t)),u=n.attr("id"),i=w2ui[u],i&&(t?i.lock("",!0):i.unlock()))}),u}(n.Data.BindingBehavior);n.W2GridBindingBehavior=r;u=function(t){function i(n){return t.call(this,n)||this}return __extends(i,t),Object.defineProperty(i.prototype,"DefaultOption",{get:function(){return{caption:"",field:"",size:null,min:"15",max:null,hidden:!1,hideable:!0,sortable:!0,searchable:!1,resizable:!0,attr:"",style:"",render:null,title:null,editable:null,frozen:!1,info:null}},enumerable:!0,configurable:!0}),i.prototype.ColumnBinding=function(t,i,r){var u=$.extend(!0,this.DefaultOption,r),f;return u.caption=t,u.field=n.LamdaExpression.Path(i),f=this.CurrentBehavior,f.AddColumn(u),this},i.prototype.RowStyleBinding=function(n){var t=this.CurrentBehavior;return t.RowStyleBinding=n,this},i.prototype.RowCssBinding=function(n){var t=this.CurrentBehavior;return t.RowClassBinding=n,this},i.prototype.CellStyleBinding=function(n){var t=this.CurrentBehavior;return t.CellStyleBinding=n,this},i}(n.BindingBehaviorBuilder);n.W2GridBindingBehaviorBuilder=u;n.BindingBehaviorBuilder.prototype.BuildGrid=function(t,i){var f=this,e=f.Add(new r),s,o;return e.NewAdd=function(n){return f.Add(n)},e.ItemsSource=new n.LamdaExpression(f.Owner.DataContext,t),e.GridOption=i,i.isSpinning&&(s=f.Add(new n.Data.DataBindingBehavior),s.Property=r.IsSpinningProperty,s.PInfo=new n.LamdaExpression(f.Owner.DataContext,i.isSpinning)),f.CurrentBehavior=e,o=new u(f.Owner),o.CurrentElement=f.CurrentElement,o.CurrentBehavior=f.CurrentBehavior,o}}(DomBehind||(DomBehind={})),function(){var n=function(){function n(){}return n.prototype.ShowMessage=function(){w2popup.open({width:580,height:350,title:'  <div class="alert alert-success"><strong>Success!<\/strong> This alert box could indicate a successful or positive action.<\/div>',body:'<div class="w2ui-centered">This is text inside the popup<\/div>',buttons:'<button class="w2ui-btn" onclick="w2alert(\'alert\')">Alert<\/button><button class="w2ui-btn" onclick="w2confirm(\'confirm\')">Confirm<\/button><button class="w2ui-btn" onclick="counter = 0; show();">Message<\/button>',showMax:!0})},n.prototype.ShowYesNo=function(){},n.prototype.ShowOkCancel=function(){},n}()}(DomBehind||(DomBehind={})),function(n){var t;(function(t){var i=function(){function t(){this._engaged=!1}return t.Register=function(n){!n.Element},t.Rebuild=function(n,t){var i=t.ToArray(),r,u,f,e;return i.SequenceEqual(t.__oldArray)?!1:(t.__oldArray=i,$.each(i,function(n,t){t.recid=n}),r=i.Select(function(n){var i=n;return t.DisplayMemberPath&&(i=n[t.DisplayMemberPath]),{id:n.recid,text:i,obj:n}}),u={items:r,selected:{}},t.Current!=null&&(f=t.Current.recid,e=r.FirstOrDefault(function(n){return n.id===f}),u.selected=e),n.w2field("list",u),!0)},t.prototype.OnCurrentChanged=function(n,i){var u,r,o;if(!this._engaged)if(u=n.__element,r=u.Element,String.IsNullOrWhiteSpace(i.Name))t.Rebuild(r,n),r.data("w2field").refresh();else if(i.Name==="Current"){var f=r.data("w2field"),s=n.Current.recid,e=f.options.items;e instanceof Array&&(o=e.FirstOrDefault(function(n){return n.id===s}),r.data("selected",o),f.refresh())}},t.ItemsSourceProperty=n.Data.DependencyProperty.RegisterAttached("itemsSource",function(){},function(i,r){var u,f;if(r instanceof n.Data.ListCollectionView){if(!t.Rebuild(i,r))return;u=r.__element;u||(u=r.__element=new t);u.Element=i;u.Items=r;f=i.data("w2field");f.refresh();f.__Dropdown=u;i.off("change");i.on("change",function(){var t=i.data("selected").id,n;u._engaged=!0;try{n=r.ToArray().FirstOrDefault(function(n){return n.recid==t});u.Items.Select(n)}finally{u._engaged=!1}});r.PropertyChanged.RemoveHandler(u.OnCurrentChanged);r.PropertyChanged.AddHandler(u.OnCurrentChanged)}},n.Data.UpdateSourceTrigger.Explicit,n.Data.BindingMode.OneWay,function(n){t.Register(n)}),t}();t.Dropdown=i})(t=n.Controls||(n.Controls={}))}(DomBehind||(DomBehind={})),function(n){var t=function(){function t(){this._navigator=new n.Navigation.DefaultNavigator}return Object.defineProperty(t,"Current",{get:function(){return t._app},enumerable:!0,configurable:!0}),t.Resolve=function(){if(!t._app){var i=this,r=new n.TypedFactory(i),u=r.CreateInstance();t._app=u;$(document).ready(function(){window.history.pushState(null,"",window.location.href);window.onpopstate=function(){window.history.pushState(null,"",window.location.href);t.Current.OnBrowserBack()}})}},t.prototype.OnBrowserBack=function(){},Object.defineProperty(t.prototype,"DefaultActionPolicy",{get:function(){return[]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Navigator",{get:function(){return this._navigator},enumerable:!0,configurable:!0}),t}();n.Application=t}(DomBehind||(DomBehind={})),function(n){var t=function(){function t(){this._disposed=!1}return Object.defineProperty(t.prototype,"Container",{get:function(){return this._container},set:function(n){this._container!==n&&(this._container&&(this._container.empty(),this._container=null),this._container=n)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"DataContext",{get:function(){return this._dataContext},set:function(n){this._dataContext!==n&&(this._dataContext=n)},enumerable:!0,configurable:!0}),t.prototype.OnDataContextPropertyChanged=function(n,t){this.UpdateTarget(t.Name)},t.prototype.ViewLoaded=function(){},t.prototype.Ensure=function(){if(this.DataContext){var t=this.DataContext;t.View=this;this.BindingBehaviors&&(this.BindingBehaviors.Dispose(),this.BindingBehaviors=null);this.BindingBehaviors=new n.Data.BindingBehaviorCollection;this.BuildBinding();this.Subscribe();this.BindingBehaviors.Ensure();this.DependencyValidateSetup&&this.DependencyValidateSetup();t.Initialized||(t.Initialized=!0,this.Container.Raise(n.UIElement.Initialize));this.UpdateTarget();this.Container.Raise(n.UIElement.ViewLoaded)}},t.prototype.UnSubscribe=function(){},t.prototype.Subscribe=function(){},t.prototype.CreateBindingBuilder=function(){var t=new n.BindingBehaviorBuilder(this);return t.Element(this.Container).BindingAction(n.UIElement.Initialize,function(n){return n.Initialize()}),t.Element(this.Container).BindingAction(n.UIElement.ViewLoaded,function(n){return n.ViewLoaded()}),t},t.prototype.UpdateTarget=function(n){this.BindingBehaviors&&this.BindingBehaviors.UpdateTarget(n)},t.prototype.UpdateSource=function(n){this.BindingBehaviors&&this.BindingBehaviors.UpdateSource(n)},t.prototype.Validate=function(n){var t=!0;return this.BindingBehaviors&&(this.ClearValidator(n),$.each(this.BindingBehaviors.ListDataBindingBehavior(n),function(n,i){i.BindingPolicy.Validators.Validate()||(t=!1)}),t&&this.ClearValidator(n)),this.DependencyValidate&&this.DependencyValidate(n),t},t.prototype.ClearValidator=function(n){$.each(this.BindingBehaviors.ListDataBindingBehavior(n),function(n,t){t.BindingPolicy.Validators.ClearValidator()});this.Container.ClearCustomError();this.DependencyValidateClear&&this.DependencyValidateClear(n)},t.prototype.Dispose=function(){if(!this._disposed){if(this.UnSubscribe(),this.BindingBehaviors&&(this.BindingBehaviors.Dispose(),this.BindingBehaviors=null),this.DataContext){var n=this.DataContext;n.Dispose&&n.Dispose();this.DataContext=null}this.Container&&(this.Container.empty(),this.Container=null)}this._disposed=!0},t}();n.BizView=t}(DomBehind||(DomBehind={}));__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t=function(t){function i(){var i=t.call(this)||this;return i.Initialized=!1,n.Locator.Push(i),i}return __extends(i,t),i.prototype.NotifyEvent=function(n,t){n&&n.Raise(this,t)},Object.defineProperty(i.prototype,"Title",{get:function(){return this._title},set:function(n){this._title=n;document.title=n},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"View",{get:function(){return this._view},set:function(n){this._view!==n&&(this._view=n,this.OnViewChanged())},enumerable:!0,configurable:!0}),i.prototype.OnViewChanged=function(){},i.prototype.ViewLoaded=function(){},i.prototype.UpdateTarget=function(n){this.View&&this.View.UpdateTarget(n)},i.prototype.UpdateSource=function(n){this.View&&this.View.UpdateSource(n)},i.prototype.Validate=function(n){var t=!1;return this.View&&(t=this.View.Validate(n)),t},i.prototype.WaitingOverlay=function(t,i){var r=new n.Data.WindowWaitingOverlayActionPolicy;i&&(r.Option.Image=i);this.SafeAction(t,r)},i.prototype.SafeAction=function(t){for(var f,u,e,r=[],i=1;i<arguments.length;i++)r[i-1]=arguments[i];f=new n.Data.ActionBindingBehavior;u=[new n.Data.ExceptionHandlingActionPolicy];r&&$.each(r,function(n,t){return u.push(t)});e=f.CreateActionInvoker(u);e.Do(t)},i.prototype.Catch=function(t){t.Data instanceof n.AjaxException},Object.defineProperty(i.prototype,"Navigator",{get:function(){return n.Application.Current.Navigator},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"IsEnabled",{get:function(){return this.GetProperty("IsEnabled",!0)},set:function(n){this.SetProperty("IsEnabled",n)},enumerable:!0,configurable:!0}),i.prototype.ShowInfomation=function(t,i){n.MessaageBox.ShowMessage(t,i,n.MessageStatus.Infomation)},i.prototype.ShowWarning=function(t,i){n.MessaageBox.ShowMessage(t,i,n.MessageStatus.Warning)},i.prototype.ShowError=function(t,i){n.MessaageBox.ShowMessage(t,i,n.MessageStatus.Error)},i.prototype.ShowMessage=function(t,i,r){n.MessaageBox.ShowMessage(t,i,r)},i.prototype.ShowYesNo=function(t,i,r){n.MessaageBox.ShowYesNo(t,i,r)},i.prototype.ShowOkCancel=function(t,i,r){n.MessaageBox.ShowOkCancel(t,i,r)},i.prototype.ShowModal=function(n,t){this.Navigator.ShowModal(n,t)},i.prototype.Dispose=function(){this._disposed||t.prototype.Dispose.call(this)},i}(n.NotifiableImp);n.BizViewModel=t}(DomBehind||(DomBehind={}));annotationCollection=function(){function n(){this.lazyList=[]}return n.prototype.Any=function(n,t,i){return this.lazyList.Any(function(r){return r.Selector===n&&r.ResolveViewType===t&&r.ResolveViewModelType===i})},n.prototype.Add=function(n,t,i){this.lazyList.push({Selector:n,ResolveViewType:t,ResolveViewModelType:i})},n.prototype.Remove=function(n){var t=[];$.each(this.lazyList,function(i,r){r.Selector===n&&r.ResolveViewType===r.ResolveViewType&&r.ResolveViewModelType===r.ResolveViewModelType||t.push(r)});this.lazyList=t},n.prototype.ToArray=function(){var n=[];return $.each(this.lazyList,function(t,i){return n.push(i)}),n},n.prototype.Pop=function(n){var t=this;$.each(this.ToArray(),function(i,r){n||t.Remove(r.Selector,r.ResolveViewType,r.ResolveViewModelType);$.BindingAnnotation(r.Selector,r.ResolveViewType,r.ResolveViewModelType)})},n}();__lazyCollection=new annotationCollection;$.BindingAnnotation=function(n,t,i){var r=$.Deferred(),u=$(n);return u.ready(function(){var f=$(n);if(f.length===0){__lazyCollection.Any(n,t,i)||__lazyCollection.Add(n,t,i);r.reject();return}var e=new DomBehind.TypedFactory(t()),o=new DomBehind.TypedFactory(i()),u=new DomBehind.Data.ViewViewModelBindingBehavior;u.GetView=function(){return e.CreateInstance()};u.GetViewModel=function(){return o.CreateInstance()};u.Element=$(n);u.Ensure();f.trigger("RegisteredViewViewModel",u);r.resolve()}),r.promise()},function(n){var t=function(){function n(){}return n.Push=function(t){n._container.push(t)},n.List=function(t,i){var r=[];return $.each(n._container,function(n,u){u instanceof t&&(i?i(u)&&r.push(u):r.push(u))}),r},n.First=function(t,i){var r;return $.each(n._container,function(n,u){if(u instanceof t)if(i){if(i(u))return r=u,!1}else return r=u,!1}),r},n.Remove=function(t,i){var r=[];$.each(n._container,function(n,u){u instanceof t?!i||i(u)||r.push(u):r.push(u)});n._container=r},n.Clear=function(){n._container=[]},n._container=[],n}();n.Locator=t}(DomBehind||(DomBehind={}));$.validator.setDefaults({ignore:"",errorPlacement:function(n,t){var i=t.attr("id"),r,u,e,f;i&&(r=t.prevAll('[for="'+i+'"]'),r.length!=0&&n.insertAfter(r),u=t.nextAll('[for="'+i+'"]'),u.length!=0&&n.insertAfter(u),e=t.closest("form"),f=e.find('[for="'+i+'"]'),f.length!=0&&n.insertAfter(f),r.length===0&&u.length===0&&f.length===0&&n.insertAfter(t))}}),function(n){n.BizView.prototype.DependencyValidateSetup=function(){var i=this,t=i.Container;t&&(t.is("form")||(t=t.find("form")),t.length==0&&(t=t.closest("form")),t.length!=0)&&$.each(i.BindingBehaviors.ListDataBindingBehavior(),function(t,i){$.each(i.BindingPolicy.Validators.toArray(),function(t,r){var u=i.Element,f=u.attr("identity"),o,h,e,c,s;u.attr("identity")||(f=NewUid().Replace("-",""),u.attr("identity",f));o="cls-"+f;u.hasClass(o)||u.addClass(o);h=u.attr("name");String.IsNullOrWhiteSpace(h)&&u.attr("name","name-"+f);e="func-"+f;c=JSON.parse('{ "'+e+'": { "'+e+'": true }  }');$.validator.addClassRules(o,c);r instanceof n.Validation.RequiredValidator&&(s=$.validator.methods.required,r.Message?$.validator.addMethod(""+e,s,r.Message):$.validator.addMethod(""+e,s,""))})})};n.BizView.prototype.DependencyValidate=function(t){var r=this,i=r.Container;i&&(i.is("form")||(i=i.find("form")),i.length==0&&(i=i.closest("form")),i.length!=0)&&$.each(r.BindingBehaviors.ListDataBindingBehavior(t),function(t,i){$.each(i.BindingPolicy.Validators.toArray(),function(t,r){var u=i.Element;r instanceof n.Validation.RequiredValidator&&u.attr(r.Attribute)&&u.removeAttr(r.Attribute);u.valid()})})};n.BizView.prototype.DependencyValidateClear=function(){var i=this,n=i.Container,t;n&&(n.is("form")||(n=n.find("form")),n.length==0&&(n=n.closest("form")),n.length!=0)&&(t=n.validate(),t&&t.resetForm())}}(DomBehind||(DomBehind={}));
//# sourceMappingURL=dombehind.min.js.map